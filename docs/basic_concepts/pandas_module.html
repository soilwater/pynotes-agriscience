<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andres Patrignani">
<meta name="dcterms.date" content="2024-01-08">
<meta name="keywords" content="pandas, dataframe, tabular, tables">

<title>PyNotes in Agriscience - 27&nbsp; Pandas module</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../basic_concepts/plotting.html" rel="next">
<link href="../basic_concepts/numpy_module.html" rel="prev">
<link href="../favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-N9033JNDWZ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-N9033JNDWZ', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../basic_concepts/basic_operations.html">BASIC CONCEPTS</a></li><li class="breadcrumb-item"><a href="../basic_concepts/pandas_module.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Pandas module</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">PyNotes in Agriscience</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/soilwater/pynotes-agriscience" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="../PyNotes-in-Agriscience.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">GETTING STARTED</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../markdown/inspiration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Inspiration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../markdown/reproducible_research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reproducible Research</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../markdown/coding_guidelines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Coding Guidelines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../markdown/installing_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Installing packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../markdown/terminal_commands.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Useful Terminal Commands</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../markdown/git_commands.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Useful Git commands</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../markdown/my_first_repo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">First Github repository</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../markdown/markdown_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Markdown basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../markdown/latex_equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">LaTeX equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../markdown/alt_python_libraries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Python libraries</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">BASIC CONCEPTS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/basic_operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Basic operations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/import_modules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Import modules</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/data_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Data types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Data structures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/dates_and_times.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Working with dates and times</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/indexing_and_slicing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Indexing and slicing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/if_statement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">If statements</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/lambda_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Lambda functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/inputs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Inputs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/for_loop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">For loop</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/while_loop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">While loop</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/objects_and_classes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Objects and classes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/error_handling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Error handling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/numpy_module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Numpy module</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/pandas_module.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Pandas module</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/plotting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Plotting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/widgets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Widgets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basic_concepts/sql_database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">SQLite Database</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">EXERCISES</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/meteogram.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Meteogram</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/group_least_variance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Group with least variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/random_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Random Plot Generator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/random_walk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Particle Random Walk</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/curve_number.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Runoff</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/mixing_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Mixing problems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/mass_volume_relationships.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Mass-volume relationships</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/soil_textural_class.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Soil textural classes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/distribution_daily_precipitation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Distribution daily precipitation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/high_resolution_rainfall_events.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">High-resolution rainfall events</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/first_and_last_frost.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">First and last frost</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/air_temperature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Air Temperature</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/evapotranspiration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Potential Evapotranspiration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/thermal_time.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Growing degree days</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/central_dogma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Central dogma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/frontier_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Frontier production functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/soil_water_storage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Soil Water Storage</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/plant_available_water.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Plant Available Water</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/photoperiod.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Photoperiod</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/solar_radiation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Solar Radiation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/evapotranspiration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Potential Evapotranspiration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/soil_temperature_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Soil Temperature Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/soil_water_retention_curve.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Soil Water Retention Curve</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/proctor_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Proctor test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/count_seeds.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Counting seeds</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/canopy_cover.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Canopy cover</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/denoise_yield_monitor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Cleaning yield monitor data</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#create-dataframe-from-existing-variable" id="toc-create-dataframe-from-existing-variable" class="nav-link active" data-scroll-target="#create-dataframe-from-existing-variable">Create DataFrame from existing variable</a></li>
  <li><a href="#basic-methods-and-properties" id="toc-basic-methods-and-properties" class="nav-link" data-scroll-target="#basic-methods-and-properties">Basic methods and properties</a></li>
  <li><a href="#convert-strings-to-datetime" id="toc-convert-strings-to-datetime" class="nav-link" data-scroll-target="#convert-strings-to-datetime">Convert strings to datetime</a></li>
  <li><a href="#extract-information-from-the-timestamp" id="toc-extract-information-from-the-timestamp" class="nav-link" data-scroll-target="#extract-information-from-the-timestamp">Extract information from the timestamp</a></li>
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values">Missing values</a></li>
  <li><a href="#quick-statistics" id="toc-quick-statistics" class="nav-link" data-scroll-target="#quick-statistics">Quick statistics</a></li>
  <li><a href="#indexing-and-slicing" id="toc-indexing-and-slicing" class="nav-link" data-scroll-target="#indexing-and-slicing">Indexing and slicing</a>
  <ul class="collapse">
  <li><a href="#using-index-operator" id="toc-using-index-operator" class="nav-link" data-scroll-target="#using-index-operator">Using index operator <code>[]</code></a></li>
  </ul></li>
  <li><a href="#select-rows" id="toc-select-rows" class="nav-link" data-scroll-target="#select-rows">Select rows</a></li>
  <li><a href="#select-columns" id="toc-select-columns" class="nav-link" data-scroll-target="#select-columns">Select columns</a></li>
  <li><a href="#slicing-rows-and-columns" id="toc-slicing-rows-and-columns" class="nav-link" data-scroll-target="#slicing-rows-and-columns">Slicing rows and columns</a>
  <ul class="collapse">
  <li><a href="#using-iloc-method" id="toc-using-iloc-method" class="nav-link" data-scroll-target="#using-iloc-method">Using <code>iloc</code> method</a></li>
  <li><a href="#using-loc-method" id="toc-using-loc-method" class="nav-link" data-scroll-target="#using-loc-method">Using <code>loc</code> method</a></li>
  </ul></li>
  <li><a href="#filter-data-using-boolean-indexing" id="toc-filter-data-using-boolean-indexing" class="nav-link" data-scroll-target="#filter-data-using-boolean-indexing">Filter data using boolean indexing</a></li>
  <li><a href="#pandas-custom-date-range" id="toc-pandas-custom-date-range" class="nav-link" data-scroll-target="#pandas-custom-date-range">Pandas custom date range</a></li>
  <li><a href="#select-range-of-dates-with-boolean-indexing" id="toc-select-range-of-dates-with-boolean-indexing" class="nav-link" data-scroll-target="#select-range-of-dates-with-boolean-indexing">Select range of dates with boolean indexing</a></li>
  <li><a href="#add-and-remove-columns" id="toc-add-and-remove-columns" class="nav-link" data-scroll-target="#add-and-remove-columns">Add and remove columns</a></li>
  <li><a href="#reset-dataframe-index" id="toc-reset-dataframe-index" class="nav-link" data-scroll-target="#reset-dataframe-index">Reset DataFrame index</a></li>
  <li><a href="#merge-two-dataframes" id="toc-merge-two-dataframes" class="nav-link" data-scroll-target="#merge-two-dataframes">Merge two dataframes</a></li>
  <li><a href="#operations-with-real-dataset" id="toc-operations-with-real-dataset" class="nav-link" data-scroll-target="#operations-with-real-dataset">Operations with real dataset</a>
  <ul class="collapse">
  <li><a href="#match-specific-stations" id="toc-match-specific-stations" class="nav-link" data-scroll-target="#match-specific-stations">Match specific stations</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.dev/soilwater/pynotes-agriscience/blob/main/basic_concepts/pandas_module.ipynb" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Pandas module</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andres Patrignani </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 8, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>Pandas is a powerful library primarily used for tabular data analysis. It offers data structures like DataFrames and Series, which make tasks such as data cleaning and aggregation easy. Pandas integrates well with other libraries like Numpy, and can read data saved in various text formats and spreadsheet software like MS Excel. One of the hallmarks of Pandas Dataframes is that we can call data stored in rows and columns by name, similar to working with Python dictionaries.</p>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import modules</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="create-dataframe-from-existing-variable" class="level2">
<h2 class="anchored" data-anchor-id="create-dataframe-from-existing-variable">Create DataFrame from existing variable</h2>
<p>After importing the module we have two possible directions. We import data from a file or we convert an existing variable into a Pandas DataFrame. Here we will create a simple DatFrame to learn the basics. This way we will be able to display the result of our operations without worrying about extensive datasets.</p>
<p>Let’s create a dictionary with some weather data and missing values (represented by <code>-9999</code>).</p>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dictionary with some weather data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">'timestamp'</span>: [<span class="st">'1/1/2000'</span>,<span class="st">'2/1/2000'</span>,<span class="st">'3/1/2000'</span>,<span class="st">'4/1/2000'</span>,<span class="st">'5/1/2000'</span>], </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'windSpeed'</span>: [<span class="fl">2.2</span>, <span class="fl">3.2</span>, <span class="op">-</span><span class="fl">9999.0</span>, <span class="fl">4.1</span>, <span class="fl">2.9</span>], </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'windDirection'</span>: [<span class="st">'E'</span>, <span class="st">'NW'</span>, <span class="st">'NW'</span>, <span class="st">'N'</span>, <span class="st">'S'</span>],</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'precipitation'</span>: [<span class="dv">0</span>, <span class="dv">18</span>, <span class="dv">25</span>, <span class="dv">2</span>, <span class="dv">0</span>]}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The next step consists of converting the dictionary into a Pandas DataFrame. This is straight forward using the DataFrame method of the Pandas modules <code>pd.DataFrame()</code></p>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert dictionary into DataFrame</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1/1/2000</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2/1/2000</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3/1/2000</td>
<td>-9999.0</td>
<td>NW</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4/1/2000</td>
<td>4.1</td>
<td>N</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5/1/2000</td>
<td>2.9</td>
<td>S</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>To display the DataFrame content simply use the <code>head()</code> and <code>tail()</code> methods. As an alternative you can use the <code>print()</code> function or type the name of the DataFrame and hit <code>ctrl + Enter</code>. Note that by default Jupyter Lab highlights the different table rows when using the second option, so for readability purposes I will use the second option from now on.</p>
</blockquote>
<p>Dissecting the DataFrame above we find the following main components:</p>
<ol type="1">
<li><p>header row containing column names</p></li>
<li><p>index (the left-most column with numbers from 0 to 4) is equivalent to a row name.</p></li>
<li><p>Each column has data of the same type.</p></li>
</ol>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By default, values in Pandas series are Numpy arrays</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">"windSpeed"</span>].values)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(df[<span class="st">"windSpeed"</span>].values))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[ 2.200e+00  3.200e+00 -9.999e+03  4.100e+00  2.900e+00]
&lt;class 'numpy.ndarray'&gt;</code></pre>
</div>
</div>
</section>
<section id="basic-methods-and-properties" class="level2">
<h2 class="anchored" data-anchor-id="basic-methods-and-properties">Basic methods and properties</h2>
<p>Pandas DataFrame has dedicated functions to display a limited number of heading and tailing rows.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">3</span>) <span class="co"># First three rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1/1/2000</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2/1/2000</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3/1/2000</td>
<td>-9999.0</td>
<td>NW</td>
<td>25</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df.tail(<span class="dv">3</span>) <span class="co"># Last three rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3/1/2000</td>
<td>-9999.0</td>
<td>NW</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4/1/2000</td>
<td>4.1</td>
<td>N</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5/1/2000</td>
<td>2.9</td>
<td>S</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>To start handling our data we need to learn how to retrieve data from the Pandas DataFrame. If we don’t know the column names of the dataset we can print them using the column property. We can also inspect the data type of each column as well as its total number of elements and shape.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df.columns  <span class="co"># Column names</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>Index(['timestamp', 'windSpeed', 'windDirection', 'precipitation'], dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df.size  <span class="co"># Total number of elements</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>20</code></pre>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df.shape  <span class="co"># Number of rows and columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>(5, 4)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df.dtypes  <span class="co"># Data type for each column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>timestamp         object
windSpeed        float64
windDirection     object
precipitation      int64
dtype: object</code></pre>
</div>
</div>
</section>
<section id="convert-strings-to-datetime" class="level2">
<h2 class="anchored" data-anchor-id="convert-strings-to-datetime">Convert strings to datetime</h2>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert dates in string format to Pandas datetime format</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># %d = day in format 00 days</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># %m = month in format 00 months</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># %Y = full year</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"timestamp"</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">"timestamp"</span>], <span class="bu">format</span><span class="op">=</span><span class="st">"</span><span class="sc">%d</span><span class="st">/%m/%Y"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-01</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-02</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-03</td>
<td>-9999.0</td>
<td>NW</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000-01-04</td>
<td>4.1</td>
<td>N</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2000-01-05</td>
<td>2.9</td>
<td>S</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that the format of our `timestamp` column change to datetime format</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>timestamp        datetime64[ns]
windSpeed               float64
windDirection            object
precipitation             int64
dtype: object</code></pre>
</div>
</div>
</section>
<section id="extract-information-from-the-timestamp" class="level2">
<h2 class="anchored" data-anchor-id="extract-information-from-the-timestamp">Extract information from the timestamp</h2>
<p>Here we can obtain the day, month, year, and even other components such hours, minutes and nanoseconds fromt he timestamp. Having a separate column for some of these components can be extremely helpful in case we want to aggregate data. For instnance, to compute the monthly mean air temperature we need to know in what month each temperature record was obtained.</p>
<p>For this we will use the <code>dt</code> submodule within <code>Pandas</code>.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the day of the year</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"doy"</span>] <span class="op">=</span> df[<span class="st">"timestamp"</span>].dt.dayofyear</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-01</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-02</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-03</td>
<td>-9999.0</td>
<td>NW</td>
<td>25</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000-01-04</td>
<td>4.1</td>
<td>N</td>
<td>2</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2000-01-05</td>
<td>2.9</td>
<td>S</td>
<td>0</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Note that the new column was placed at the end. This the default when creating a new column.</p>
</blockquote>
<p>The next example makes use of the <code>insert()</code> method to add the new column on a specific location. Typically for dates and date components we want to have the columns at the beginning, close to the datetime. For other variables the previous approach that appends the new column at the end of the DataFrame will work just fine.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get month from timstamp and create new column</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#.insert(positionOfNewColumn, nameOfNewColumn, dataOfNewColumn)</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>df.insert(<span class="dv">1</span>,<span class="st">'month'</span>,df[<span class="st">"timestamp"</span>].dt.month)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-01</td>
<td>1</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-02</td>
<td>1</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-03</td>
<td>1</td>
<td>-9999.0</td>
<td>NW</td>
<td>25</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000-01-04</td>
<td>1</td>
<td>4.1</td>
<td>N</td>
<td>2</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2000-01-05</td>
<td>1</td>
<td>2.9</td>
<td>S</td>
<td>0</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>If you re-run the previous cell you will get an error since Pandas prevents having two columns with the same name.</p>
</blockquote>
</section>
<section id="missing-values" class="level2">
<h2 class="anchored" data-anchor-id="missing-values">Missing values</h2>
<p>One of the most common operations when working with data is to handle missing values. Almost every dataset has missing data and there is no universal way of denoting missing values. Most common placeholders are: <code>NaN</code>, <code>NA</code>, <code>-99</code>, <code>-9999</code>, <code>missing</code>. To find out more about how missing data is represented in your dataset read associated documentation files.</p>
<p>I typically prefer to use <code>NaN</code> (personal preference since I also use Matlab frequently). In many datasets missing data may already by imported as NaN or NA, meaning that you can directly use the <code>fillna()</code> method without this intermediary step.</p>
<p>To replace missing values we will follow these steps:</p>
<ol type="1">
<li><p>Identify the cells with <code>-9999</code> values. Output will be a logical DataFrame having the same dimensions as <code>df</code>.</p></li>
<li><p>Replace <code>-9999</code> with <code>NaN</code> values. Note that I’m using <code>NaN</code> values from <strong>Numpy</strong>.</p></li>
<li><p>Check our work using the <code>isna()</code> method (optional)</p></li>
</ol>
<blockquote class="blockquote">
<p>Pandas offers a machinery to deal with missing data, meaning that it is not necessary to replace these values in order to make computations with the data. We just need to ensure that missing values are in the right format. In some cases an option would be to replace missing data with an estimate value, like using the average of the values immediately above and below or using the average for the entire data (not ideal)using the <code>fillna()</code> method. For instance: <code>df.fillna(df.windSpeed.mean())</code></p>
</blockquote>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: find -9999 values across the entire dataframe</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>idx_missing <span class="op">=</span> df.isin([<span class="op">-</span><span class="dv">9999</span>])</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>idx_missing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find missing vlaues in only one column</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"windSpeed"</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">9999</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>0    False
1    False
2     True
3    False
4    False
Name: windSpeed, dtype: bool</code></pre>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Replace missing values with NaN</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>df[idx_missing] <span class="op">=</span> np.nan</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-01</td>
<td>1</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-02</td>
<td>1</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-03</td>
<td>1</td>
<td>NaN</td>
<td>NW</td>
<td>25</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000-01-04</td>
<td>1</td>
<td>4.1</td>
<td>N</td>
<td>2</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2000-01-05</td>
<td>1</td>
<td>2.9</td>
<td>S</td>
<td>0</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NaNs are of type float</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(np.nan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>float</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Check our work</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>df.isna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="quick-statistics" class="level2">
<h2 class="anchored" data-anchor-id="quick-statistics">Quick statistics</h2>
<p>DataFrames have a variety of methods to calculate simple statistics. To obtain an overall summary we can use the <code>describe()</code> method.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary stats for all columns</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.describe())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       month  windSpeed  precipitation       doy
count    5.0   4.000000         5.0000  5.000000
mean     1.0   3.100000         9.0000  3.000000
std      0.0   0.787401        11.7047  1.581139
min      1.0   2.200000         0.0000  1.000000
25%      1.0   2.725000         0.0000  2.000000
50%      1.0   3.050000         2.0000  3.000000
75%      1.0   3.425000        18.0000  4.000000
max      1.0   4.100000        25.0000  5.000000</code></pre>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Metric ignoring NaN values</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">"windSpeed"</span>].<span class="bu">max</span>())         <span class="co"># Maximum value for each column</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">"windSpeed"</span>].mean())        <span class="co"># Average value for each column</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">"windSpeed"</span>].<span class="bu">min</span>())         <span class="co"># Minimum value for each column</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">"windSpeed"</span>].std())         <span class="co"># Standard deviation value for each column</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">"windSpeed"</span>].var())         <span class="co"># Variance value for each column</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">"windSpeed"</span>].median())      <span class="co"># Variance value for each column</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">"windSpeed"</span>].quantile(<span class="fl">0.95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4.1
3.1
2.2
0.7874007874011809
0.6199999999999997
3.05
3.9649999999999994</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cumulative sum. Useful to compute cumulative precipitation</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.precipitation.cumsum())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0     0
1    18
2    43
3    45
4    45
Name: precipitation, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Unique values. Useful to compute unique wind directions</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.windDirection.unique())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['E' 'NW' 'N' 'S']</code></pre>
</div>
</div>
</section>
<section id="indexing-and-slicing" class="level2">
<h2 class="anchored" data-anchor-id="indexing-and-slicing">Indexing and slicing</h2>
<section id="using-index-operator" class="level3">
<h3 class="anchored" data-anchor-id="using-index-operator">Using index operator <code>[]</code></h3>
<p>To start making computations with need to access the data insde the Pandas DataFrame. Indexing and slicing are useful operations to select portions of data by calling specific rows, columns, or a combination of both. The index operator <code>[]</code> is primarily intended to be used with column labels (e.g.&nbsp;<code>df[columnName]</code>), however, it can also handle row slices (e.g.&nbsp;<code>df[rows]</code>). A common notation useful to understand how the slicing works is as follows:</p>
</section>
</section>
<section id="select-rows" class="level2">
<h2 class="anchored" data-anchor-id="select-rows">Select rows</h2>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">0</span>:<span class="dv">3</span>] <span class="co"># First three rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-01</td>
<td>1</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-02</td>
<td>1</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-03</td>
<td>1</td>
<td>NaN</td>
<td>NW</td>
<td>25</td>
<td>3</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="select-columns" class="level2">
<h2 class="anchored" data-anchor-id="select-columns">Select columns</h2>
<p>We can call individual columns using the <code>dot</code> or <code>bracket</code> notation. Note that in option 2 there is no <code>.</code> between <code>df</code> and <code>['windSpeed']</code></p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df.windSpeed    <span class="co"># Option 1</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'windSpeed'</span>] <span class="co"># Option 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>0    2.2
1    3.2
2    NaN
3    4.1
4    2.9
Name: windSpeed, dtype: float64</code></pre>
</div>
</div>
<p>To pass more than one row of column you will need to group them in a list.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select multiple columns at once</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">'windSpeed'</span>,<span class="st">'windDirection'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2.2</td>
<td>E</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3.2</td>
<td>NW</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>NW</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4.1</td>
<td>N</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2.9</td>
<td>S</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>A common mistake when slicing multiple columns is to forget grouping column names into a list, so the following command will not work:</p>
<p><code>df['windSpeed','windDirection']</code></p>
</section>
<section id="slicing-rows-and-columns" class="level2">
<h2 class="anchored" data-anchor-id="slicing-rows-and-columns">Slicing rows and columns</h2>
<section id="using-iloc-method" class="level3">
<h3 class="anchored" data-anchor-id="using-iloc-method">Using <code>iloc</code> method</h3>
<p><code>iloc</code>: Integer-location. <code>iloc</code> gets rows (or columns) at specific indexes. It only takes integers as input. <strong>Exclusive of its endpoint</strong></p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Top 3 rows and columns 1 and 2</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="dv">0</span>:<span class="dv">3</span>,[<span class="dv">1</span>,<span class="dv">2</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>2.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>3.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Top 2 rows and all columns</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="dv">0</span>:<span class="dv">2</span>,:] <span class="co"># Same as: df.iloc[0:2]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-01</td>
<td>1</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-02</td>
<td>1</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Although a bit more verbose and perhaps less <em>pythonic</em>, I prefer to specify <code>all the columns</code> using the <code>:</code> character. In my opinion this notation is more explicit and clearly states the rows and columns of the slicing operation. So, <code>df.iloc[0:2,:]</code> is preferred over <code>df.iloc[0:2]</code>.</p>
</section>
<section id="using-loc-method" class="level3">
<h3 class="anchored" data-anchor-id="using-loc-method">Using <code>loc</code> method</h3>
<p><code>loc</code> gets rows (or columns) with specific labels. <strong>Inclusive of its endpoint</strong></p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select multiple rows and columns at once using the loc method</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>df.loc[<span class="dv">0</span>:<span class="dv">2</span>,[<span class="st">'windSpeed'</span>,<span class="st">'windDirection'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2.2</td>
<td>E</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3.2</td>
<td>NW</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>NW</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Some rows and all columns</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>df.loc[<span class="dv">0</span>:<span class="dv">1</span>,:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-01</td>
<td>1</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-02</td>
<td>1</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First three elements of a single column</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>df.loc[<span class="dv">0</span>:<span class="dv">2</span>,<span class="st">'windSpeed'</span>]  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>0    2.2
1    3.2
2    NaN
Name: windSpeed, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First three elements of multiple columns</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>df.loc[<span class="dv">0</span>:<span class="dv">2</span>,[<span class="st">'windSpeed'</span>,<span class="st">'windDirection'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2.2</td>
<td>E</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3.2</td>
<td>NW</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>NW</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>These statements will not work with <code>loc</code>:</p>
<p><code>df.loc[0:2,0:1]</code></p>
<p><code>df.loc[[0:2],[0:1]]</code></p>
</section>
</section>
<section id="filter-data-using-boolean-indexing" class="level2">
<h2 class="anchored" data-anchor-id="filter-data-using-boolean-indexing">Filter data using boolean indexing</h2>
<p>Boolean indexing (a.k.a. logical indexing) consists of creating a boolean array with True/False values as a consequence of conditional statement that can be use to select the rows that meet the specified condition. Logical indexing are often not intuitive for students learning how to program, but are incredibly powerful and I highly encourage its use.</p>
<p>Let’s select all the data for days that have wind speed greater than 3 meters per second. We will first select the rows of <code>df.windSpeed</code> that are greater than 3 m/s, and then we will use the resulting boolean to slice the DataFrame.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> df.windSpeed <span class="op">&gt;</span> <span class="dv">3</span> <span class="co"># Rows in which the wind speed is greater than </span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>idx  <span class="co"># Let's inspect the idx variable.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>0    False
1     True
2    False
3     True
4    False
Name: windSpeed, dtype: bool</code></pre>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now let's apply the boolean variable to the dataframe</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>df[idx]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-02</td>
<td>1</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000-01-04</td>
<td>1</td>
<td>4.1</td>
<td>N</td>
<td>2</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can also apply the boolean to specific columns</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>df.loc[idx,<span class="st">'windDirection'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>1    NW
3     N
Name: windDirection, dtype: object</code></pre>
</div>
</div>
<p>It’s also possible to write the previous command with the conditional statement in a single line of code. This is fine to do, but sometimes nesting too many conditions can create commands that are hard to understand. I typically recommend storing the boolean results in a new variable that is easier to pass around. This is particularly helpful if you are planning to re-use the boolean in multiple lines of you code.</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same in a single line of code</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>df.loc[df.windSpeed <span class="op">&gt;</span> <span class="dv">3</span>,<span class="st">'windDirection'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>1    NW
3     N
Name: windDirection, dtype: object</code></pre>
</div>
</div>
<p>Another popular way of filtering is to check whether an element or group of elements are within a set. If you come from Matlab the following example is similar to the <code>ismember()</code> function.</p>
<p>Let’s check whether January 1 and January 2 are in the dataframe.</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>idx_doy <span class="op">=</span> df[<span class="st">'doy'</span>].isin([<span class="dv">1</span>,<span class="dv">2</span>])  <span class="co">#list(range(1,5))</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>idx_doy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>0     True
1     True
2    False
3    False
4    False
Name: doy, dtype: bool</code></pre>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>df.loc[idx_doy,:] <span class="co"># Select all columns for the selected days of the year</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-01</td>
<td>1</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-02</td>
<td>1</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="pandas-custom-date-range" class="level2">
<h2 class="anchored" data-anchor-id="pandas-custom-date-range">Pandas custom date range</h2>
<p>In this particular case we have the day of the year to indicate time, however, in many occasions is better to handle dates. Often times dates are already present in the dataset, but if they aren’t then we can create and handle dates with Pandas.</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>subset_dates <span class="op">=</span> pd.date_range(<span class="st">'20000102'</span>, periods<span class="op">=</span><span class="dv">2</span>, freq<span class="op">=</span><span class="st">'D'</span>) <span class="co"># Used df.shape[0] to find the total number of rows</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>subset_dates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>DatetimeIndex(['2000-01-02', '2000-01-03'], dtype='datetime64[ns]', freq='D')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The same to generate months</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>pd.date_range(<span class="st">'20200101'</span>, periods<span class="op">=</span>df.shape[<span class="dv">0</span>], freq<span class="op">=</span><span class="st">'M'</span>) <span class="co"># Specify the frequency to months</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>DatetimeIndex(['2020-01-31', '2020-02-29', '2020-03-31', '2020-04-30',
               '2020-05-31'],
              dtype='datetime64[ns]', freq='M')</code></pre>
</div>
</div>
</section>
<section id="select-range-of-dates-with-boolean-indexing" class="level2">
<h2 class="anchored" data-anchor-id="select-range-of-dates-with-boolean-indexing">Select range of dates with boolean indexing</h2>
<p>Now that we covered both boolean indexing and pandas dates we can use these concepts to select data from a specific window of time. This is a pretty common operation when trying to select a subset of the entire DataFrame by a specific date range.</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate boolean for rows that match the subset of dates generated earlier</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>idx_subset <span class="op">=</span> df[<span class="st">"timestamp"</span>].isin(subset_dates)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>idx_subset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>0    False
1     True
2     True
3    False
4    False
Name: timestamp, dtype: bool</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a new DataFrame using only the rows with matching dates</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>df_subset <span class="op">=</span> df.loc[idx_subset]</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>df_subset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-02</td>
<td>1</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-03</td>
<td>1</td>
<td>NaN</td>
<td>NW</td>
<td>25</td>
<td>3</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># It isn't always necessary to generate a new DataFrame</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># So you can access a specific column like this</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>df.loc[idx_subset,<span class="st">"precipitation"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>1    18
2    25
Name: precipitation, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="add-and-remove-columns" class="level2">
<h2 class="anchored" data-anchor-id="add-and-remove-columns">Add and remove columns</h2>
<p>The <code>insert()</code> and <code>drop()</code> methods allow us to add or remove columns to/from the DataFrame. The most common use of these functions is as follows:</p>
<p><code>df.insert(indexOfNewColumn, nameOfNewColumn, dataArrayOfNewColumn)</code></p>
<p><code>df.drop(nameOfColumnToBeRemoved)</code></p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new column at a specific location</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>df.insert(<span class="dv">2</span>, <span class="st">'airTemperature'</span>, [<span class="fl">25.4</span>, <span class="dv">26</span>, <span class="fl">27.1</span>, <span class="fl">28.9</span>, <span class="fl">30.2</span>]) <span class="co"># Similar to: df['dates'] = dates</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">airTemperature</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-01</td>
<td>1</td>
<td>25.4</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-02</td>
<td>1</td>
<td>26.0</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-03</td>
<td>1</td>
<td>27.1</td>
<td>NaN</td>
<td>NW</td>
<td>25</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000-01-04</td>
<td>1</td>
<td>28.9</td>
<td>4.1</td>
<td>N</td>
<td>2</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2000-01-05</td>
<td>1</td>
<td>30.2</td>
<td>2.9</td>
<td>S</td>
<td>0</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove specific column</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>df.drop(columns<span class="op">=</span>[<span class="st">'airTemperature'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-01</td>
<td>1</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-02</td>
<td>1</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-03</td>
<td>1</td>
<td>NaN</td>
<td>NW</td>
<td>25</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000-01-04</td>
<td>1</td>
<td>4.1</td>
<td>N</td>
<td>2</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2000-01-05</td>
<td>1</td>
<td>2.9</td>
<td>S</td>
<td>0</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="reset-dataframe-index" class="level2">
<h2 class="anchored" data-anchor-id="reset-dataframe-index">Reset DataFrame index</h2>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace the index by a variables of our choice</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>df.set_index(<span class="st">'doy'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">airTemperature</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">doy</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-01</td>
<td>1</td>
<td>25.4</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-02</td>
<td>1</td>
<td>26.0</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>2000-01-03</td>
<td>1</td>
<td>27.1</td>
<td>NaN</td>
<td>NW</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>2000-01-04</td>
<td>1</td>
<td>28.9</td>
<td>4.1</td>
<td>N</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>2000-01-05</td>
<td>1</td>
<td>30.2</td>
<td>2.9</td>
<td>S</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset the index (see that 'doy' goes back to the end of the DataFrame again)</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>df.reset_index(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">airTemperature</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>2000-01-01</td>
<td>1</td>
<td>25.4</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2000-01-02</td>
<td>1</td>
<td>26.0</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>2000-01-03</td>
<td>1</td>
<td>27.1</td>
<td>NaN</td>
<td>NW</td>
<td>25</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>2000-01-04</td>
<td>1</td>
<td>28.9</td>
<td>4.1</td>
<td>N</td>
<td>2</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>2000-01-05</td>
<td>1</td>
<td>30.2</td>
<td>2.9</td>
<td>S</td>
<td>0</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="merge-two-dataframes" class="level2">
<h2 class="anchored" data-anchor-id="merge-two-dataframes">Merge two dataframes</h2>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new DataFrame (follows dates)</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Dictionary</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> {<span class="st">'timestamp'</span>: [<span class="st">'6/1/2000'</span>,<span class="st">'7/1/2000'</span>,<span class="st">'8/1/2000'</span>,<span class="st">'9/1/2000'</span>,<span class="st">'10/1/2000'</span>], </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'windSpeed'</span>: [<span class="fl">4.3</span>, <span class="fl">2.1</span>, <span class="fl">0.5</span>, <span class="fl">2.7</span>, <span class="fl">1.9</span>], </span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'windDirection'</span>: [<span class="st">'N'</span>, <span class="st">'N'</span>, <span class="st">'SW'</span>, <span class="st">'E'</span>, <span class="st">'NW'</span>],</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'precipitation'</span>: [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">0</span>]}</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Dcitionary to DataFrame</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame(data2)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert strings to pandas datetime</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">"timestamp"</span>] <span class="op">=</span> pd.to_datetime(df2[<span class="st">"timestamp"</span>], <span class="bu">format</span><span class="op">=</span><span class="st">"</span><span class="sc">%d</span><span class="st">/%m/%Y"</span>) </span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>df2.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-06</td>
<td>4.3</td>
<td>N</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-07</td>
<td>2.1</td>
<td>N</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-08</td>
<td>0.5</td>
<td>SW</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000-01-09</td>
<td>2.7</td>
<td>E</td>
<td>25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2000-01-10</td>
<td>1.9</td>
<td>NW</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Not using the <code>format="%d/%m/%y"</code> in the previous cell results in the wrong datetime conversion. It is always recommended to specify the format.</p>
</blockquote>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge both Dataframes using an union of keys from both frames (how='outer' option)</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>df_merged <span class="op">=</span> pd.merge(df, df2, how<span class="op">=</span><span class="st">'outer'</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>df_merged</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">airTemperature</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-01</td>
<td>1.0</td>
<td>25.4</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-02</td>
<td>1.0</td>
<td>26.0</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-03</td>
<td>1.0</td>
<td>27.1</td>
<td>NaN</td>
<td>NW</td>
<td>25</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000-01-04</td>
<td>1.0</td>
<td>28.9</td>
<td>4.1</td>
<td>N</td>
<td>2</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2000-01-05</td>
<td>1.0</td>
<td>30.2</td>
<td>2.9</td>
<td>S</td>
<td>0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2000-01-06</td>
<td>NaN</td>
<td>NaN</td>
<td>4.3</td>
<td>N</td>
<td>0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2000-01-07</td>
<td>NaN</td>
<td>NaN</td>
<td>2.1</td>
<td>N</td>
<td>0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2000-01-08</td>
<td>NaN</td>
<td>NaN</td>
<td>0.5</td>
<td>SW</td>
<td>0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2000-01-09</td>
<td>NaN</td>
<td>NaN</td>
<td>2.7</td>
<td>E</td>
<td>25</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>2000-01-10</td>
<td>NaN</td>
<td>NaN</td>
<td>1.9</td>
<td>NW</td>
<td>0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Note how <code>NaN</code> values were assigned to variables not present in the new DataFrame</p>
</blockquote>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create another DataFrame with more limited data. Values every other day</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>data3 <span class="op">=</span> {<span class="st">'timestamp'</span>: [<span class="st">'1/1/2000'</span>,<span class="st">'3/1/2000'</span>,<span class="st">'5/1/2000'</span>,<span class="st">'7/1/2000'</span>,<span class="st">'9/1/2000'</span>], </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">'pressure'</span>: [<span class="dv">980</span>, <span class="dv">987</span>, <span class="dv">985</span>, <span class="dv">991</span>, <span class="dv">990</span>]}  <span class="co"># Pressure in millibars</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> pd.DataFrame(data3)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>df3[<span class="st">"timestamp"</span>] <span class="op">=</span> pd.to_datetime(df3[<span class="st">"timestamp"</span>], <span class="bu">format</span><span class="op">=</span><span class="st">"</span><span class="sc">%d</span><span class="st">/%m/%Y"</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>df3.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">pressure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-01</td>
<td>980</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-03</td>
<td>987</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-05</td>
<td>985</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000-01-07</td>
<td>991</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2000-01-09</td>
<td>990</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only the matching rows will be merged</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>df_merged.merge(df3,on<span class="op">=</span><span class="st">"timestamp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">airTemperature</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
<th data-quarto-table-cell-role="th">pressure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-01</td>
<td>1.0</td>
<td>25.4</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
<td>1.0</td>
<td>980</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-03</td>
<td>1.0</td>
<td>27.1</td>
<td>NaN</td>
<td>NW</td>
<td>25</td>
<td>3.0</td>
<td>987</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-05</td>
<td>1.0</td>
<td>30.2</td>
<td>2.9</td>
<td>S</td>
<td>0</td>
<td>5.0</td>
<td>985</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000-01-07</td>
<td>NaN</td>
<td>NaN</td>
<td>2.1</td>
<td>N</td>
<td>0</td>
<td>NaN</td>
<td>991</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2000-01-09</td>
<td>NaN</td>
<td>NaN</td>
<td>2.7</td>
<td>E</td>
<td>25</td>
<td>NaN</td>
<td>990</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only add values from the new, more sporadic, variable where there is a match.</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>df_merged.merge(df3, how<span class="op">=</span><span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">airTemperature</th>
<th data-quarto-table-cell-role="th">windSpeed</th>
<th data-quarto-table-cell-role="th">windDirection</th>
<th data-quarto-table-cell-role="th">precipitation</th>
<th data-quarto-table-cell-role="th">doy</th>
<th data-quarto-table-cell-role="th">pressure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-01</td>
<td>1.0</td>
<td>25.4</td>
<td>2.2</td>
<td>E</td>
<td>0</td>
<td>1.0</td>
<td>980.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-02</td>
<td>1.0</td>
<td>26.0</td>
<td>3.2</td>
<td>NW</td>
<td>18</td>
<td>2.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-03</td>
<td>1.0</td>
<td>27.1</td>
<td>NaN</td>
<td>NW</td>
<td>25</td>
<td>3.0</td>
<td>987.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000-01-04</td>
<td>1.0</td>
<td>28.9</td>
<td>4.1</td>
<td>N</td>
<td>2</td>
<td>4.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2000-01-05</td>
<td>1.0</td>
<td>30.2</td>
<td>2.9</td>
<td>S</td>
<td>0</td>
<td>5.0</td>
<td>985.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2000-01-06</td>
<td>NaN</td>
<td>NaN</td>
<td>4.3</td>
<td>N</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2000-01-07</td>
<td>NaN</td>
<td>NaN</td>
<td>2.1</td>
<td>N</td>
<td>0</td>
<td>NaN</td>
<td>991.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2000-01-08</td>
<td>NaN</td>
<td>NaN</td>
<td>0.5</td>
<td>SW</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2000-01-09</td>
<td>NaN</td>
<td>NaN</td>
<td>2.7</td>
<td>E</td>
<td>25</td>
<td>NaN</td>
<td>990.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>2000-01-10</td>
<td>NaN</td>
<td>NaN</td>
<td>1.9</td>
<td>NW</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="operations-with-real-dataset" class="level2">
<h2 class="anchored" data-anchor-id="operations-with-real-dataset">Operations with real dataset</h2>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read CSV file</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>data_url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/soilwater/pynotes-agriscience/gh-pages/datasets/ok_mesonet_8_apr_2019.csv"</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(data_url, sep<span class="op">=</span><span class="st">','</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">STID</th>
<th data-quarto-table-cell-role="th">NAME</th>
<th data-quarto-table-cell-role="th">ST</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">YR</th>
<th data-quarto-table-cell-role="th">MO</th>
<th data-quarto-table-cell-role="th">DA</th>
<th data-quarto-table-cell-role="th">HR</th>
<th data-quarto-table-cell-role="th">MI</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">RELH</th>
<th data-quarto-table-cell-role="th">CHIL</th>
<th data-quarto-table-cell-role="th">HEAT</th>
<th data-quarto-table-cell-role="th">WDIR</th>
<th data-quarto-table-cell-role="th">WSPD</th>
<th data-quarto-table-cell-role="th">WMAX</th>
<th data-quarto-table-cell-role="th">PRES</th>
<th data-quarto-table-cell-role="th">TMAX</th>
<th data-quarto-table-cell-role="th">TMIN</th>
<th data-quarto-table-cell-role="th">RAIN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ACME</td>
<td>Acme</td>
<td>OK</td>
<td>34.81</td>
<td>-98.02</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>ADAX</td>
<td>Ada</td>
<td>OK</td>
<td>34.80</td>
<td>-96.67</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>40</td>
<td></td>
<td></td>
<td>S</td>
<td>12</td>
<td>20</td>
<td>1011.13</td>
<td>78</td>
<td>48</td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>ALTU</td>
<td>Altus</td>
<td>OK</td>
<td>34.59</td>
<td>-99.34</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>39</td>
<td></td>
<td>82</td>
<td>SSW</td>
<td>19</td>
<td>26</td>
<td>1007.86</td>
<td>82</td>
<td>45</td>
<td></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>ALV2</td>
<td>Alva</td>
<td>OK</td>
<td>36.71</td>
<td>-98.71</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>32</td>
<td></td>
<td>82</td>
<td>S</td>
<td>20</td>
<td>26</td>
<td>1004.65</td>
<td>84</td>
<td>40</td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>ANT2</td>
<td>Antlers</td>
<td>OK</td>
<td>34.25</td>
<td>-95.67</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>35</td>
<td></td>
<td></td>
<td>S</td>
<td>11</td>
<td>20</td>
<td>1013.64</td>
<td>78</td>
<td>38</td>
<td></td>
</tr>
</tbody>
</table>

<p>5 rows × 22 columns</p>
</div>
</div>
</div>
<p>Some columns seem to have empty cells. Ideally we would like to see these cells filled with <code>NaN</code> values. Something looks fishy here. Let’s inspect some of these cell.</p>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print one the cells to see what's in there</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>df.loc[<span class="dv">0</span>,<span class="st">'RAIN'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>' '</code></pre>
</div>
</div>
<p>In the inspected cell we found a string with a single space in it. Now we can use the <code>replace()</code> method to substitute these strings for <code>NaN</code> from the Numpy module.</p>
<p>The <code>inplace=True</code> replaces the string with <code>NaN</code> without generating a copy of the Pandas Dataframe</p>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>df.replace(<span class="st">' '</span>, np.nan, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">STID</th>
<th data-quarto-table-cell-role="th">NAME</th>
<th data-quarto-table-cell-role="th">ST</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">YR</th>
<th data-quarto-table-cell-role="th">MO</th>
<th data-quarto-table-cell-role="th">DA</th>
<th data-quarto-table-cell-role="th">HR</th>
<th data-quarto-table-cell-role="th">MI</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">RELH</th>
<th data-quarto-table-cell-role="th">CHIL</th>
<th data-quarto-table-cell-role="th">HEAT</th>
<th data-quarto-table-cell-role="th">WDIR</th>
<th data-quarto-table-cell-role="th">WSPD</th>
<th data-quarto-table-cell-role="th">WMAX</th>
<th data-quarto-table-cell-role="th">PRES</th>
<th data-quarto-table-cell-role="th">TMAX</th>
<th data-quarto-table-cell-role="th">TMIN</th>
<th data-quarto-table-cell-role="th">RAIN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ACME</td>
<td>Acme</td>
<td>OK</td>
<td>34.81</td>
<td>-98.02</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>ADAX</td>
<td>Ada</td>
<td>OK</td>
<td>34.80</td>
<td>-96.67</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>40</td>
<td>NaN</td>
<td>NaN</td>
<td>S</td>
<td>12</td>
<td>20</td>
<td>1011.13</td>
<td>78</td>
<td>48</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>ALTU</td>
<td>Altus</td>
<td>OK</td>
<td>34.59</td>
<td>-99.34</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>39</td>
<td>NaN</td>
<td>82</td>
<td>SSW</td>
<td>19</td>
<td>26</td>
<td>1007.86</td>
<td>82</td>
<td>45</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>ALV2</td>
<td>Alva</td>
<td>OK</td>
<td>36.71</td>
<td>-98.71</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>32</td>
<td>NaN</td>
<td>82</td>
<td>S</td>
<td>20</td>
<td>26</td>
<td>1004.65</td>
<td>84</td>
<td>40</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>ANT2</td>
<td>Antlers</td>
<td>OK</td>
<td>34.25</td>
<td>-95.67</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>35</td>
<td>NaN</td>
<td>NaN</td>
<td>S</td>
<td>11</td>
<td>20</td>
<td>1013.64</td>
<td>78</td>
<td>38</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>5 rows × 22 columns</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The previous solution is not the best. We could have resolved the issue with the empty strings by simply adding the following option <code>na_values=' '</code> to the <code>pd.read_csv()</code> function, like this: df = pd.read_csv(data_url, sep=‘,’, na_values=’ ’). This will automatically populate all cells with <code>' '</code> with <code>NaN</code> values. We just did not know this in advance.</p>
</div>
</div>
<section id="match-specific-stations" class="level3">
<h3 class="anchored" data-anchor-id="match-specific-stations">Match specific stations</h3>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>idx_acme <span class="op">=</span> df[<span class="st">'STID'</span>].<span class="bu">str</span>.match(<span class="st">'ACME'</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>df[idx_acme]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">STID</th>
<th data-quarto-table-cell-role="th">NAME</th>
<th data-quarto-table-cell-role="th">ST</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">YR</th>
<th data-quarto-table-cell-role="th">MO</th>
<th data-quarto-table-cell-role="th">DA</th>
<th data-quarto-table-cell-role="th">HR</th>
<th data-quarto-table-cell-role="th">MI</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">RELH</th>
<th data-quarto-table-cell-role="th">CHIL</th>
<th data-quarto-table-cell-role="th">HEAT</th>
<th data-quarto-table-cell-role="th">WDIR</th>
<th data-quarto-table-cell-role="th">WSPD</th>
<th data-quarto-table-cell-role="th">WMAX</th>
<th data-quarto-table-cell-role="th">PRES</th>
<th data-quarto-table-cell-role="th">TMAX</th>
<th data-quarto-table-cell-role="th">TMIN</th>
<th data-quarto-table-cell-role="th">RAIN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ACME</td>
<td>Acme</td>
<td>OK</td>
<td>34.81</td>
<td>-98.02</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>1 rows × 22 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>idx_starts_with_A <span class="op">=</span> df[<span class="st">'STID'</span>].<span class="bu">str</span>.match(<span class="st">'A'</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>df[idx_starts_with_A]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">STID</th>
<th data-quarto-table-cell-role="th">NAME</th>
<th data-quarto-table-cell-role="th">ST</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">YR</th>
<th data-quarto-table-cell-role="th">MO</th>
<th data-quarto-table-cell-role="th">DA</th>
<th data-quarto-table-cell-role="th">HR</th>
<th data-quarto-table-cell-role="th">MI</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">RELH</th>
<th data-quarto-table-cell-role="th">CHIL</th>
<th data-quarto-table-cell-role="th">HEAT</th>
<th data-quarto-table-cell-role="th">WDIR</th>
<th data-quarto-table-cell-role="th">WSPD</th>
<th data-quarto-table-cell-role="th">WMAX</th>
<th data-quarto-table-cell-role="th">PRES</th>
<th data-quarto-table-cell-role="th">TMAX</th>
<th data-quarto-table-cell-role="th">TMIN</th>
<th data-quarto-table-cell-role="th">RAIN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ACME</td>
<td>Acme</td>
<td>OK</td>
<td>34.81</td>
<td>-98.02</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>ADAX</td>
<td>Ada</td>
<td>OK</td>
<td>34.80</td>
<td>-96.67</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>40</td>
<td>NaN</td>
<td>NaN</td>
<td>S</td>
<td>12</td>
<td>20</td>
<td>1011.13</td>
<td>78</td>
<td>48</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>ALTU</td>
<td>Altus</td>
<td>OK</td>
<td>34.59</td>
<td>-99.34</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>39</td>
<td>NaN</td>
<td>82</td>
<td>SSW</td>
<td>19</td>
<td>26</td>
<td>1007.86</td>
<td>82</td>
<td>45</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>ALV2</td>
<td>Alva</td>
<td>OK</td>
<td>36.71</td>
<td>-98.71</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>32</td>
<td>NaN</td>
<td>82</td>
<td>S</td>
<td>20</td>
<td>26</td>
<td>1004.65</td>
<td>84</td>
<td>40</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>ANT2</td>
<td>Antlers</td>
<td>OK</td>
<td>34.25</td>
<td>-95.67</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>35</td>
<td>NaN</td>
<td>NaN</td>
<td>S</td>
<td>11</td>
<td>20</td>
<td>1013.64</td>
<td>78</td>
<td>38</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>APAC</td>
<td>Apache</td>
<td>OK</td>
<td>34.91</td>
<td>-98.29</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>41</td>
<td>NaN</td>
<td>NaN</td>
<td>S</td>
<td>23</td>
<td>29</td>
<td>1008.9</td>
<td>80</td>
<td>49</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>ARD2</td>
<td>Ardmore</td>
<td>OK</td>
<td>34.19</td>
<td>-97.09</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>41</td>
<td>NaN</td>
<td>NaN</td>
<td>S</td>
<td>18</td>
<td>26</td>
<td>1011.43</td>
<td>77</td>
<td>50</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>ARNE</td>
<td>Arnett</td>
<td>OK</td>
<td>36.07</td>
<td>-99.90</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>10</td>
<td>NaN</td>
<td>85</td>
<td>SW</td>
<td>22</td>
<td>32</td>
<td>1005.13</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>8 rows × 22 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>idx_has_A <span class="op">=</span> df[<span class="st">'STID'</span>].<span class="bu">str</span>.contains(<span class="st">'A'</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>df[idx_has_A].head(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">STID</th>
<th data-quarto-table-cell-role="th">NAME</th>
<th data-quarto-table-cell-role="th">ST</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">YR</th>
<th data-quarto-table-cell-role="th">MO</th>
<th data-quarto-table-cell-role="th">DA</th>
<th data-quarto-table-cell-role="th">HR</th>
<th data-quarto-table-cell-role="th">MI</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">RELH</th>
<th data-quarto-table-cell-role="th">CHIL</th>
<th data-quarto-table-cell-role="th">HEAT</th>
<th data-quarto-table-cell-role="th">WDIR</th>
<th data-quarto-table-cell-role="th">WSPD</th>
<th data-quarto-table-cell-role="th">WMAX</th>
<th data-quarto-table-cell-role="th">PRES</th>
<th data-quarto-table-cell-role="th">TMAX</th>
<th data-quarto-table-cell-role="th">TMIN</th>
<th data-quarto-table-cell-role="th">RAIN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ACME</td>
<td>Acme</td>
<td>OK</td>
<td>34.81</td>
<td>-98.02</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>ADAX</td>
<td>Ada</td>
<td>OK</td>
<td>34.80</td>
<td>-96.67</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>40</td>
<td>NaN</td>
<td>NaN</td>
<td>S</td>
<td>12</td>
<td>20</td>
<td>1011.13</td>
<td>78</td>
<td>48</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>ALTU</td>
<td>Altus</td>
<td>OK</td>
<td>34.59</td>
<td>-99.34</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>39</td>
<td>NaN</td>
<td>82</td>
<td>SSW</td>
<td>19</td>
<td>26</td>
<td>1007.86</td>
<td>82</td>
<td>45</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>ALV2</td>
<td>Alva</td>
<td>OK</td>
<td>36.71</td>
<td>-98.71</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>32</td>
<td>NaN</td>
<td>82</td>
<td>S</td>
<td>20</td>
<td>26</td>
<td>1004.65</td>
<td>84</td>
<td>40</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>ANT2</td>
<td>Antlers</td>
<td>OK</td>
<td>34.25</td>
<td>-95.67</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>35</td>
<td>NaN</td>
<td>NaN</td>
<td>S</td>
<td>11</td>
<td>20</td>
<td>1013.64</td>
<td>78</td>
<td>38</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>APAC</td>
<td>Apache</td>
<td>OK</td>
<td>34.91</td>
<td>-98.29</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>41</td>
<td>NaN</td>
<td>NaN</td>
<td>S</td>
<td>23</td>
<td>29</td>
<td>1008.9</td>
<td>80</td>
<td>49</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>ARD2</td>
<td>Ardmore</td>
<td>OK</td>
<td>34.19</td>
<td>-97.09</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>41</td>
<td>NaN</td>
<td>NaN</td>
<td>S</td>
<td>18</td>
<td>26</td>
<td>1011.43</td>
<td>77</td>
<td>50</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>ARNE</td>
<td>Arnett</td>
<td>OK</td>
<td>36.07</td>
<td>-99.90</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>10</td>
<td>NaN</td>
<td>85</td>
<td>SW</td>
<td>22</td>
<td>32</td>
<td>1005.13</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>BEAV</td>
<td>Beaver</td>
<td>OK</td>
<td>36.80</td>
<td>-100.53</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>9</td>
<td>NaN</td>
<td>84</td>
<td>SW</td>
<td>17</td>
<td>26</td>
<td>1003.9</td>
<td>91</td>
<td>34</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>BLAC</td>
<td>Blackwell</td>
<td>OK</td>
<td>36.75</td>
<td>-97.25</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>38</td>
<td>NaN</td>
<td>NaN</td>
<td>SSW</td>
<td>15</td>
<td>23</td>
<td>1007.02</td>
<td>80</td>
<td>44</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>BYAR</td>
<td>Byars</td>
<td>OK</td>
<td>34.85</td>
<td>-97.00</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>43</td>
<td>NaN</td>
<td>NaN</td>
<td>S</td>
<td>22</td>
<td>32</td>
<td>1010.64</td>
<td>77</td>
<td>49</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>CAMA</td>
<td>Camargo</td>
<td>OK</td>
<td>36.03</td>
<td>-99.35</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>32</td>
<td>NaN</td>
<td>82</td>
<td>S</td>
<td>23</td>
<td>29</td>
<td>1005.56</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>CARL</td>
<td>Lake Carl Blackwell</td>
<td>OK</td>
<td>36.15</td>
<td>-97.29</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>36</td>
<td>NaN</td>
<td>80</td>
<td>S</td>
<td>17</td>
<td>25</td>
<td>1007.56</td>
<td>80</td>
<td>50</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>CHAN</td>
<td>Chandler</td>
<td>OK</td>
<td>35.65</td>
<td>-96.80</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>37</td>
<td>NaN</td>
<td>NaN</td>
<td>SSW</td>
<td>16</td>
<td>27</td>
<td>1009.35</td>
<td>80</td>
<td>48</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>CLAY</td>
<td>Clayton</td>
<td>OK</td>
<td>34.66</td>
<td>-95.33</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>36</td>
<td>NaN</td>
<td>NaN</td>
<td>S</td>
<td>9</td>
<td>24</td>
<td>1012.9</td>
<td>78</td>
<td>40</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>15 rows × 22 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> df[<span class="st">'NAME'</span>].<span class="bu">str</span>.contains(<span class="st">'Blackwell'</span>) <span class="op">&amp;</span> df[<span class="st">'NAME'</span>].<span class="bu">str</span>.contains(<span class="st">'Lake'</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>df[idx]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">STID</th>
<th data-quarto-table-cell-role="th">NAME</th>
<th data-quarto-table-cell-role="th">ST</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">YR</th>
<th data-quarto-table-cell-role="th">MO</th>
<th data-quarto-table-cell-role="th">DA</th>
<th data-quarto-table-cell-role="th">HR</th>
<th data-quarto-table-cell-role="th">MI</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">RELH</th>
<th data-quarto-table-cell-role="th">CHIL</th>
<th data-quarto-table-cell-role="th">HEAT</th>
<th data-quarto-table-cell-role="th">WDIR</th>
<th data-quarto-table-cell-role="th">WSPD</th>
<th data-quarto-table-cell-role="th">WMAX</th>
<th data-quarto-table-cell-role="th">PRES</th>
<th data-quarto-table-cell-role="th">TMAX</th>
<th data-quarto-table-cell-role="th">TMIN</th>
<th data-quarto-table-cell-role="th">RAIN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>CARL</td>
<td>Lake Carl Blackwell</td>
<td>OK</td>
<td>36.15</td>
<td>-97.29</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>36</td>
<td>NaN</td>
<td>80</td>
<td>S</td>
<td>17</td>
<td>25</td>
<td>1007.56</td>
<td>80</td>
<td>50</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>1 rows × 22 columns</p>
</div>
</div>
</div>
<p>The following line won’t work because the string matching is case sensitive:</p>
<p><code>idx = df['NAME'].str.contains('LAKE')</code></p>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> df[<span class="st">'NAME'</span>].<span class="bu">str</span>.contains(<span class="st">'Blackwell'</span>) <span class="op">|</span> df[<span class="st">'NAME'</span>].<span class="bu">str</span>.contains(<span class="st">'Lake'</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>df[idx]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">STID</th>
<th data-quarto-table-cell-role="th">NAME</th>
<th data-quarto-table-cell-role="th">ST</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">YR</th>
<th data-quarto-table-cell-role="th">MO</th>
<th data-quarto-table-cell-role="th">DA</th>
<th data-quarto-table-cell-role="th">HR</th>
<th data-quarto-table-cell-role="th">MI</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">RELH</th>
<th data-quarto-table-cell-role="th">CHIL</th>
<th data-quarto-table-cell-role="th">HEAT</th>
<th data-quarto-table-cell-role="th">WDIR</th>
<th data-quarto-table-cell-role="th">WSPD</th>
<th data-quarto-table-cell-role="th">WMAX</th>
<th data-quarto-table-cell-role="th">PRES</th>
<th data-quarto-table-cell-role="th">TMAX</th>
<th data-quarto-table-cell-role="th">TMIN</th>
<th data-quarto-table-cell-role="th">RAIN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>BLAC</td>
<td>Blackwell</td>
<td>OK</td>
<td>36.75</td>
<td>-97.25</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>38</td>
<td>NaN</td>
<td>NaN</td>
<td>SSW</td>
<td>15</td>
<td>23</td>
<td>1007.02</td>
<td>80</td>
<td>44</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>CARL</td>
<td>Lake Carl Blackwell</td>
<td>OK</td>
<td>36.15</td>
<td>-97.29</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>36</td>
<td>NaN</td>
<td>80</td>
<td>S</td>
<td>17</td>
<td>25</td>
<td>1007.56</td>
<td>80</td>
<td>50</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>2 rows × 22 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> df[<span class="st">'STID'</span>].isin([<span class="st">'ACME'</span>,<span class="st">'ALTU'</span>])</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>df[idx]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="97">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">STID</th>
<th data-quarto-table-cell-role="th">NAME</th>
<th data-quarto-table-cell-role="th">ST</th>
<th data-quarto-table-cell-role="th">LAT</th>
<th data-quarto-table-cell-role="th">LON</th>
<th data-quarto-table-cell-role="th">YR</th>
<th data-quarto-table-cell-role="th">MO</th>
<th data-quarto-table-cell-role="th">DA</th>
<th data-quarto-table-cell-role="th">HR</th>
<th data-quarto-table-cell-role="th">MI</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">RELH</th>
<th data-quarto-table-cell-role="th">CHIL</th>
<th data-quarto-table-cell-role="th">HEAT</th>
<th data-quarto-table-cell-role="th">WDIR</th>
<th data-quarto-table-cell-role="th">WSPD</th>
<th data-quarto-table-cell-role="th">WMAX</th>
<th data-quarto-table-cell-role="th">PRES</th>
<th data-quarto-table-cell-role="th">TMAX</th>
<th data-quarto-table-cell-role="th">TMIN</th>
<th data-quarto-table-cell-role="th">RAIN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ACME</td>
<td>Acme</td>
<td>OK</td>
<td>34.81</td>
<td>-98.02</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>ALTU</td>
<td>Altus</td>
<td>OK</td>
<td>34.59</td>
<td>-99.34</td>
<td>2019</td>
<td>4</td>
<td>15</td>
<td>15</td>
<td>20</td>
<td>...</td>
<td>39</td>
<td>NaN</td>
<td>82</td>
<td>SSW</td>
<td>19</td>
<td>26</td>
<td>1007.86</td>
<td>82</td>
<td>45</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>2 rows × 22 columns</p>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../basic_concepts/numpy_module.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Numpy module</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../basic_concepts/plotting.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Plotting</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Material available for free under the Creative Commons Attribution-NonCommercial-ShareAlike (CC BY-NC-SA) license
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>