
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mixing Solute Problem &#8212; PyNotes in Agriscience</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Newton’s law of cooling" href="newton_law_cooling.html" />
    <link rel="prev" title="Plant Available Water" href="plant_available_water.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">PyNotes in Agriscience</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../landing-page.html">
   PyNotes in Agriscience
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/inspiration.html">
   Inspiration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/installing_software.html">
   Installating packages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/reproducible_research.html">
   Reproducible Research
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/terminal_commands.html">
   Useful Terminal Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/git_commands.html">
   Useful Git commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/my_first_repo.html">
   First Github repository
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/markdown_basics.html">
   Markdown basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/latex_equations.html">
   LaTeX equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/alt_python_libraries.html">
   Python libraries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hello_world.html">
   Hello world
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="help_resources.html">
   Python help
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Good coding practices
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/code_style.html">
   Coding Style
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/reference_framework.html">
   Coding Guidelines
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Simple computations
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="importing_modules.html">
   Importing modules
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="math_module.html">
   Math Module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="calculator_examples.html">
   Calculator Examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mass_volume_relationships.html">
   Soil Mass-Volume Relationships
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Random
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="random_module.html">
   Random module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="random_walk.html">
   Particle Random Walk
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="random_groups_of_people.html">
   Random group generator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="random_plots.html">
   Random Plot Generator
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Data types structures
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="data_types.html">
   Data Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data_structures.html">
   Data Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indexing_and_slicing_lists.html">
   Indexing and slicing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="strings.html">
   Strings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="objects.html">
   Objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="classes.html">
   Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inputs.html">
   Inputs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="input_wizard.html">
   Input Wizard
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sedimentation_time.html">
   Sedimentation time
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Directory navigation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="os_module.html">
   Operating system module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glob_module.html">
   Glob Module
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Dates and Time
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="time_module.html">
   Time module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="datetime_module.html">
   Datetime Module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="datetime_module.html#working-with-seconds">
   Working with seconds
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="leap_year.html">
   Leap years
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="day_of_year.html">
   Day of the Year
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="day_of_week.html">
   Day of the week
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Control flow
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="for_loops.html">
   For Loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="comparative_anatomy_for_loops.html">
   Comparative Anatomy of For Loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="while_loops.html">
   While loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="if_statement.html">
   If Statements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="comparative_anatomy_if_statement.html">
   Comparative Anatomy of If Statements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fibonacci_sequence.html">
   Fibonacci Sequence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sorting_numbers.html">
   Sorting Numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="error_handling.html">
   Error Handling
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Functions
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="anonymous_functions.html">
   Lambda Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="functions.html">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="comparative_anatomy_functions.html">
   Comparative Anatomy of Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="capillarity.html">
   Capillarity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pedotransfer_saxton_rawls.html">
   Pedotransfer Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_textural_class.html">
   Soil texture
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Strings
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="regular_expressions.html">
   Regular Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="matching_dna_strand.html">
   Complementary DNA sequence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="central_dogma_single_polypeptide.html">
   Central Dogma: Decoding a Single Polypeptide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="central_dogma_multiple_polypeptides.html">
   Central Dogma: Decoding Multiple Polypeptides
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="morse_decoder.html">
   Morse code decoder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="morse_encoder.html">
   Morse code encoder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="morse_code_guessing_game.html">
   Morse code guessing game
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Plotting
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="plotting_matplotlib.html">
   Basic Plots with Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plotting_seaborn.html">
   Seaborn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plotting_bokeh.html">
   Bokeh
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plotting_holoviews.html">
   Holoviews
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="interactive_apps.html">
   Interactive Application
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Numpy and Pandas
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="numpy_module.html">
   Numpy Module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vapor_pressure_deficit.html">
   Vapor Pressure Deficit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="photoperiod_numpy_module.html">
   Photoperiod
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_module.html">
   Pandas Module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="import_tabular_data.html">
   Import Tabular Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="handy_functions.html">
   Handy functions for data science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="precipitation_distribution.html">
   Precipitation Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bird_counts.html">
   Exploring Bird Counts with Pandas and HoloViews
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Web data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="url_ks_mesonet.html">
   Kansas Mesonet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="url_ok_mesonet.html">
   Oklahoma Mesonet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="url_uscrn.html">
   Climate Reference Network
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="url_nasa_api.html">
   Open NASA APIs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coronavirus.html">
   Coronavirus COVID-19 Timeseries of Global Cases
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Statistics and curve fitting
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="statistics_module.html">
   Statistics module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="error_metrics.html">
   Error Metrics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="anova.html">
   Analysis of Variance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="group_least_variance.html">
   Group with the Least Variance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats_linear_regression.html">
   Linear Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sensor_calibration.html">
   Linear Regression: Sensor Calibration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="neutron_probe_calibration.html">
   Calibration of a Neutron Probe
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="anscombe_quartet.html">
   Anscombe’s Quartet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_respiration.html">
   Soil Respiration Rate
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optimal_nitrogen_rate.html">
   Optimal Nitrogen Rate
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="proctor_test.html">
   Proctor test
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cdf_matching.html">
   CDF Matching Function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats_multiple_linear_regression.html">
   Multiple Linear Regression Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="frontier_function.html">
   Frontier Production Function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats_curve_fitting_exp.html">
   Curve Fitting: Exponential Decay
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cosmos_calibration.html">
   Neutron Counts to Volumetric Water Content
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats_curve_fitting_wave.html">
   Curve Fitting: Sinusoid
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_water_retention_curve.html">
   Soil Water Retention Curve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="atmospheric_carbon_dioxide.html">
   Atmospheric Carbon Dioxide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="birthday_paradox.html">
   Birthday Paradox
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="neural_network_regression.html">
   Neural Network Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="neural_network_classification.html">
   Neural Network Classification
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Problems in 1D
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="fill_missing_data.html">
   Fill Missing Soil Moisture Timeseries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="denoise_passive_neutron_counts.html">
   Denoising Cosmic-Ray Neutron Signal
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wheat_potential_biomass.html">
   Modeling Wheat Biomass
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wheat_phenology.html">
   Wheat phenology model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_chain.html">
   Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="antecedent_precipitation_index.html">
   Antecedent Precipitation Index
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_chain_soil_moisture.html">
   Modeling Soil Moisture
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rainfall_generator.html">
   Rainfall Generator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="precipitation_metrics.html">
   Precipitation Metrics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="atmospheric_water_deficit.html">
   Atmospheric Water Deficit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="drydowns_from_timeseries.html">
   Soil Moisture Drydowns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="air_temperature.html">
   Air Temperature
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="solar_radiation.html">
   Solar Radiation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_temperature.html">
   Understanding Soil Temperature
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_temperature_model.html">
   Soil Temperature Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_water_storage.html">
   Soil Water Storage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exponential_filter.html">
   Rootzone Soil Water from Surface Observations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plant_available_water.html">
   Plant Available Water
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Mixing Solute Problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newton_law_cooling.html">
   Newton’s law of cooling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lotka_volterra.html">
   Lotka-Volterra: Predator–Prey Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="leaky_bucket.html">
   Leaky buckets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="thermal_time.html">
   Thermal Units
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_temperature_model.html">
   Soil Temperature Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="root_depth.html">
   Root growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_water_balance.html">
   Soil Water Balance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="evaporation.html">
   Soil Evaporation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="evapotranspiration.html">
   Potential Evapotranspiration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="curve_number.html">
   Runoff
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Image analysis
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="canopeo.html">
   Green Canopy Cover
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="count_seeds.html">
   Counting seeds
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="segmented_lake.html">
   Patch analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_cracks_detection.html">
   Soil Cracks
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Mapping
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="nearest_station.html">
   Find Nearest Monitoring Station
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inverse_distance_weighting.html">
   Inverse Distance Weighting Interpolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="interpolation.html">
   Spatial Interpolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="raster_nasa_worldview.html">
   Rasters from NASA Worldview Snapshots
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="land_cover.html">
   Land Cover Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="denoise_yield_monitor.html">
   Denoise Yield Monitor Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="raster_change_crs.html">
   Change Coordinate Reference System
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="field_random_samples.html">
   Field Random Samples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="euclidean_distance.html">
   Efficient Euclidean Distance
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Numerical problems 2D
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="game_of_life.html">
   Conway’s Game of Life
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wildfire_spread.html">
   Wildfire Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reaction_diffusion.html">
   Gray-Scott Model of Reaction-Diffusion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="disease_spread.html">
   Disease Spread
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Clustering
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="clustering_environments.html">
   Environmental Agroregions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_water_deficit_classification.html">
   Clustering Time Series
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="field_management_zones.html">
   Field Management Zones
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Symbolic math
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="sympy_module.html">
   Sympy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="logistic_growth.html">
   Logistic Growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="population_growth.html">
   Population Growth
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/mixing_model.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/soilwater/pynotes-agriscience"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/soilwater/pynotes-agriscience/master?urlpath=tree/notebooks/mixing_model.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-1-calculate-time-to-overflow">
   Step 1: Calculate time to overflow
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-2-add-the-calculation-of-the-amount-of-salt">
   Step 2: Add the calculation of the amount of salt
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-numpy">
   Using Numpy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-charts">
   Plot charts
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#practice">
   Practice
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="mixing-solute-problem">
<h1>Mixing Solute Problem<a class="headerlink" href="#mixing-solute-problem" title="Permalink to this headline">¶</a></h1>
<p>A 1500 gallon tank initially contains 600 gallons of water with 5 lbs of salt dissolved in it. Water enters the tank at a rate of 9 gal/hr and the water entering the tank has a salt concentration of <span class="math notranslate nohighlight">\(\frac{1}{5}(1 + cos(t))\)</span> lbs/gal. If a well-mixed solution leaves the tank at a rate of 6 gal/hr:</p>
<ul class="simple">
<li><p>how long does it take for the tank to overflow?</p></li>
<li><p>how much salt (total amount in lbs) is in the entire tank when it overflows?</p></li>
</ul>
<p>Assume each iteration is equivalent to one hour</p>
<div class="section" id="step-1-calculate-time-to-overflow">
<h2>Step 1: Calculate time to overflow<a class="headerlink" href="#step-1-calculate-time-to-overflow" title="Permalink to this headline">¶</a></h2>
<p>In this step we will leave the calculation of the mass of salt aside. The goal is to solve the first question first since we have all the information readily available in the problem statement . Thinking about the second question or trying to solve both at the same time can make this problem more difficult than it actual is. A good way of thinking about this problem is as computing the balance of a checking account (tank level), where we have credits (inflow rate) and debits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First step: Calculate tank level and time of overflow using a for loop</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="c1"># Initial parameters</span>
<span class="n">tank_capacity</span> <span class="o">=</span> <span class="mi">1500</span> <span class="c1"># gallons</span>
<span class="n">tank_level</span> <span class="o">=</span> <span class="mi">600</span>     <span class="c1"># gallons Initial tank_level</span>
<span class="n">inflow_rate</span> <span class="o">=</span> <span class="mi">9</span>      <span class="c1"># gal/hr</span>
<span class="n">outflow_rate</span> <span class="o">=</span> <span class="mi">6</span>     <span class="c1"># gal/hr</span>

<span class="c1"># Compute tank volume and salt mass at time t until tank is full</span>
<span class="n">counter_hours</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">tank_level</span> <span class="o">&lt;</span> <span class="n">tank_capacity</span><span class="p">:</span>
    <span class="n">tank_level</span> <span class="o">=</span> <span class="n">tank_level</span> <span class="o">+</span> <span class="n">inflow_rate</span> <span class="o">-</span> <span class="n">outflow_rate</span>   
    <span class="n">counter_hours</span> <span class="o">+=</span> <span class="mi">1</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hours:&#39;</span><span class="p">,</span><span class="n">hours</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tank level:&#39;</span><span class="p">,</span><span class="n">tank_level</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hours: 300
Tank level: 1500
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="step-2-add-the-calculation-of-the-amount-of-salt">
<h2>Step 2: Add the calculation of the amount of salt<a class="headerlink" href="#step-2-add-the-calculation-of-the-amount-of-salt" title="Permalink to this headline">¶</a></h2>
<p>Now that we understand the problem in simple terms and we were able to implement it in Python is time to add the computation of the total salt at each time step. In this step is important to realize that concentration is amount of salt per unit volume of water, in this case gallons of water. Following the same reasoning for the first part of the problem, we need to calculate the balance of salt inside the tank, which is the result of the salt inflows and outflows plus whatever salt we had at the beginning. The initial amount of salt in the tank is analogous to the initial water in the tank or a seed money on a new bank account. So, to solve the problem we need:</p>
<ul class="simple">
<li><p>the inflow rate of water with salt</p></li>
<li><p>the salt concentration of the inflow rate</p></li>
<li><p>the outflow rate of water with salt</p></li>
<li><p>the salt concentration of the outflow rate (<strong>we need to calculate this</strong>)</p></li>
</ul>
<p>From the statement we have the first 3 pieces of information, but we lack the last one. Since concetration is mass of salt per unit volume of water, we just need to divide the total amount of salt over the current volume of water in the tank. So at the beginning we have 5 lbs/600 gallons = 0.0083 lbs/gal, which will be the salt concentration of the outflow during the first hour. Becasue the amount of water and salt in the tank change every hour, we need to include these computations in each iteration to update the salt concentration of the outflow.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="c1"># Initial parameters</span>
<span class="n">tank_capacity</span> <span class="o">=</span> <span class="mi">1500</span> <span class="c1"># gallons</span>
<span class="n">tank_level</span> <span class="o">=</span> <span class="mi">600</span>    <span class="c1"># gallons</span>
<span class="n">salt_mass</span> <span class="o">=</span> <span class="mi">5</span>        <span class="c1"># lbs</span>
<span class="n">inflow_rate</span> <span class="o">=</span> <span class="mi">9</span>      <span class="c1"># gal/hr</span>
<span class="n">outflow_rate</span> <span class="o">=</span> <span class="mi">6</span>     <span class="c1"># gal/hr</span>
<span class="n">counter_hours</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Compute tank volume and salt mass at time t until tank is full</span>
<span class="k">while</span> <span class="n">tank_level</span> <span class="o">&lt;</span> <span class="n">tank_capacity</span><span class="p">:</span>
   
    <span class="n">salt_inflow</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">counter_hours</span><span class="p">))</span> <span class="o">*</span> <span class="n">inflow_rate</span>
    <span class="n">salt_outflow</span> <span class="o">=</span> <span class="n">salt_mass</span><span class="o">/</span><span class="n">tank_level</span> <span class="o">*</span> <span class="n">outflow_rate</span>
    <span class="n">salt_mass</span> <span class="o">=</span> <span class="n">salt_mass</span> <span class="o">+</span> <span class="n">salt_inflow</span> <span class="o">-</span> <span class="n">salt_outflow</span>
    <span class="n">tank_level</span> <span class="o">=</span> <span class="n">tank_level</span> <span class="o">+</span> <span class="n">inflow_rate</span> <span class="o">-</span> <span class="n">outflow_rate</span>
    <span class="n">counter_hours</span> <span class="o">+=</span> <span class="mi">1</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hours:&#39;</span><span class="p">,</span><span class="n">hours</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tank level:&#39;</span><span class="p">,</span><span class="n">tank_level</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mass of salt in the tank when overflowing:&#39;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">salt_mass</span><span class="p">),</span><span class="s1">&#39;lbs&#39;</span><span class="p">)</span>
        
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hours: 300
Tank level: 1500
Mass of salt when overflowing: 280 lbs
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="using-numpy">
<h2>Using Numpy<a class="headerlink" href="#using-numpy" title="Permalink to this headline">¶</a></h2>
<p>An alternative solution using numpy, pre-allocating arrays using NaNs, a for loop, and storing variables for posterior plotting. Of course, you can also keep track of the variables by using regular Python lists in combination with the append method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Initial parameters</span>
<span class="n">period</span> <span class="o">=</span> <span class="mi">1000</span>        <span class="c1"># Large number of hours to ensurehours</span>
<span class="n">tank_level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="c1"># Pre-allocate array with NaNs</span>
<span class="n">salt_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>  <span class="c1"># Pre-allocate array with NaNs</span>
<span class="n">tank_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">600</span>   <span class="c1"># gallons</span>
<span class="n">salt_mass</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>        <span class="c1"># lbs</span>
<span class="n">tank_capacity</span> <span class="o">=</span> <span class="mi">1500</span> <span class="c1"># gallons</span>
<span class="n">inflow_rate</span> <span class="o">=</span> <span class="mi">9</span>      <span class="c1"># gal/hr</span>
<span class="n">outflow_rate</span> <span class="o">=</span> <span class="mi">6</span>     <span class="c1"># gal/hr</span>

<span class="c1"># Compute tank volume and salt mass at time t until tank is full</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">period</span><span class="p">):</span>
    
    <span class="c1"># The salt concentration will be computed using the tank level of the previous hour</span>
    <span class="n">salt_inflow</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="o">*</span> <span class="n">inflow_rate</span>          <span class="c1"># lbs/gal ranges between 0 and 0.4</span>
    <span class="n">salt_outflow</span> <span class="o">=</span> <span class="n">salt_mass</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">tank_level</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">outflow_rate</span>
    <span class="n">salt_mass</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">salt_mass</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">salt_inflow</span> <span class="o">-</span> <span class="n">salt_outflow</span>
    
    <span class="c1"># Now we can update the tank level</span>
    <span class="n">tank_level</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">tank_level</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">inflow_rate</span> <span class="o">-</span> <span class="n">outflow_rate</span>   <span class="c1"># volume of the tank</span>
   
    <span class="c1"># Added &lt;greater than&gt; just in case the tank level does not exactly match the tank capacity value</span>
    <span class="c1"># For instance, if we set the condition to &#39;==&#39; and the tank_level changes from 1499 to 1501</span>
    <span class="c1"># between two iteration steps, then the loop will never stop.</span>
    <span class="k">if</span> <span class="n">tank_level</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">tank_capacity</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;hours&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">salt_mass</span><span class="p">[</span><span class="n">t</span><span class="p">]),</span><span class="s1">&#39;lbs of salt&#39;</span><span class="p">)</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>300 hours
280.0 lbs of salt
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-charts">
<h2>Plot charts<a class="headerlink" href="#plot-charts" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">period</span><span class="p">),</span><span class="n">tank_level</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hours&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tank level (gallons)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">period</span><span class="p">),</span><span class="n">salt_mass</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hours&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Salt mass in the tank (lbs)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1"># Plot every 5 values to clearly see the curve in the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">period</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">period</span><span class="p">,</span><span class="mi">5</span><span class="p">))))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hours&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Inflow sal concentration (lbs/gal)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/mixing_model_8_0.png" src="../_images/mixing_model_8_0.png" />
<img alt="../_images/mixing_model_8_1.png" src="../_images/mixing_model_8_1.png" />
<img alt="../_images/mixing_model_8_2.png" src="../_images/mixing_model_8_2.png" />
</div>
</div>
</div>
<div class="section" id="practice">
<h2>Practice<a class="headerlink" href="#practice" title="Permalink to this headline">¶</a></h2>
<p>A farmer is preparing to control weeds in a field crop using a sprayer with a tank containing 100 liters of fresh water. The recommended herbice concentration to control the weeds without affecting the crop is 2%, which means that the farmer would need to add 2 liters of herbice to the tank. However, due to an error while measuring the herbicide, the farmer adds 3 liters of herbicide instead of 2 liters, which will certainly kill the weeds, but may also damage the crop. To fix the problem, the farmer decides to open the outflow valve to let some herbicide solution out of the tank at a rate of 3 liters per minute, while at the same time, adding fresh water from the top of the tank at a rate of 3 liters per minute. Assume that the tank has a stirrer that keeps the solution well-mixed (i.e. the herbicide concentration at any given time is homogenous across the tank).</p>
<p>This is a clever solution, diluting the chemical solution is a much better alternative than disposing the entire load of the tank, which could contaminate the surrrounding area. So, minimizing the chemical waste is desirable over disposing the entire chemical solution in this situation.</p>
<ul class="simple">
<li><p>Create a Markdown table listing variable names, magnitudes, and units.</p></li>
<li><p>Solve the problem numerically using python.</p></li>
<li><p>Indicate the time in minutes at which the herbicide concentration in the tank is restored at 2% (0.02 liters of herbicede per liter of fresh water). In other words, you need to find the time at which the farmer needs to close the outflow valve.</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solution: 13.5 minutes
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="n">x</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x t&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve Left-hand side</span>
<span class="n">LHS</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">LHS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-log(300) + log(200)
</pre></div>
</div>
</div>
</div>
<p>If we were doing this computation by hand we could use the quotient rule of logarithms:</p>
<div class="math notranslate nohighlight">
\[ log \frac{M}{N} = log(M) - log(N)\]</div>
<p>to further simplify this expression. Sympy provides the <code class="docutils literal notranslate"><span class="pre">simplify</span></code> function to help us with this operation, which is handy not only to make our equation simpler, but also to keep the entire process of solving the problem symbolically fully reproducible:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LHS</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">LHS</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">LHS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>log(2/3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve Right-hand side</span>
<span class="n">RHS</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">RHS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.03*t
</pre></div>
</div>
</div>
</div>
<p>A common pitfall in sympy when trying to set equality between two terms is to use the <code class="docutils literal notranslate"><span class="pre">=</span></code> symbol. This will not work since <code class="docutils literal notranslate"><span class="pre">=</span></code> is the assignment operator, not equality. In our case, to set the <code class="docutils literal notranslate"><span class="pre">LHS</span> <span class="pre">=</span> <span class="pre">RHS</span></code> we can use the following expression:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Eq</span><span class="p">(</span><span class="n">LHS</span><span class="p">,</span> <span class="n">RHS</span><span class="p">)</span>
</pre></div>
</div>
<p>This will return a new expression that then we can use to solve for <em>t</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the LHS = RHS</span>
<span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">RHS</span><span class="p">,</span><span class="n">LHS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - 0.03 t = \log{\left(\frac{2}{3} \right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now solve for time t, which should be the answer to our problem (in minutes).</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">RHS</span><span class="p">,</span><span class="n">LHS</span><span class="p">),</span><span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Answer is:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;minutes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Answer is: 13.52 minutes
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>The examples in this notebook were adapted from problems and exercises in Morris. Tenenbaum and Pollard, H., 1963. Ordinary differential equations: an elementary textbook for students of mathematics, engineering, and the sciences. Dover Publications.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="plant_available_water.html" title="previous page">Plant Available Water</a>
    <a class='right-next' id="next-link" href="newton_law_cooling.html" title="next page">Newton’s law of cooling</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Andres Patrignani<br/>
        
            &copy; Copyright 2021.<br/>
          <div class="extra_footer">
            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Licensed under CC BY-NC-SA</a>
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'G-SKSSW7LW32', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>