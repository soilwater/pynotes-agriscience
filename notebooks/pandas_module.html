
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pandas Module &#8212; Pynotes in Agriscience</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Import Tabular Data" href="import_tabular_data.html" />
    <link rel="prev" title="Photoperiod" href="photoperiod_numpy_module.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-126565767-4', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Pynotes in Agriscience</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   PyNotes in Agriscience
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/inspiration.html">
   Inspiration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/installing_software.html">
   Installating packages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/reproducible_research.html">
   Reproducible Research
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/terminal_commands.html">
   Useful Terminal Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/git_commands.html">
   Useful Git commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/my_first_repo.html">
   First Github repository
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/markdown_basics.html">
   Markdown basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/latex_equations.html">
   LaTeX equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/alt_python_libraries.html">
   Python libraries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="basic_operations.html">
   Basic Operations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="help_resources.html">
   Python help
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Good coding practices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/coding_style.html">
   Good Coding Habits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../markdown/coding_guideline.html">
   Coding Guidelines
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Simple computations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="calculator_examples.html">
   Using Python as a Calculator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="importing_modules.html">
   Importing modules
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="math_module.html">
   Math Module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mass_volume_relationships.html">
   Soil Mass-Volume Relationships
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Random
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="random_module.html">
   Random module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="random_walk.html">
   Particle Random Walk
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="random_groups_of_people.html">
   Random group generator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="random_plots.html">
   Random Plot Generator
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data types structures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="data_types.html">
   Data Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data_structures.html">
   Data Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indexing_and_slicing_lists.html">
   Indexing and slicing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="strings.html">
   Strings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="objects.html">
   Objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="classes.html">
   Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inputs.html">
   Inputs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simple_lab_db.html">
   Simple Laboratory Database
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sedimentation_time.html">
   Sedimentation time
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Directory navigation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="os_module.html">
   Operating system module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glob_module.html">
   Glob Module
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dates and Time
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="time_module.html">
   Time module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="datetime_module.html">
   Datetime Module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="leap_year.html">
   Leap years
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="day_of_year.html">
   Day of the Year
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="day_of_week.html">
   Day of the week
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Control flow
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="for_loops.html">
   For Loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="comparative_anatomy_for_loops.html">
   Comparative Anatomy of For Loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="while_loops.html">
   While loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="if_statement.html">
   If Statements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="comparative_anatomy_if_statement.html">
   Comparative Anatomy of If Statements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fibonacci_sequence.html">
   Fibonacci Sequence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sorting_numbers.html">
   Sorting Numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="error_handling.html">
   Error Handling
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Functions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="anonymous_functions.html">
   Lambda Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="functions.html">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="comparative_anatomy_functions.html">
   Comparative Anatomy of Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="capillarity.html">
   Capillarity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pedotransfer_saxton_rawls.html">
   Pedotransfer Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_textural_class.html">
   Soil texture
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Strings
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="regular_expressions.html">
   Regular Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="matching_dna_strand.html">
   Complementary DNA sequence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="central_dogma_single_polypeptide.html">
   Central Dogma: Decoding a Single Polypeptide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="central_dogma_multiple_polypeptides.html">
   Central Dogma: Decoding Multiple Polypeptides
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="morse_decoder.html">
   Morse code decoder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="morse_encoder.html">
   Morse code encoder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="morse_code_guessing_game.html">
   Morse code guessing game
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Plotting
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plotting_matplotlib.html">
   Basic Plots with Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plotting_seaborn.html">
   Seaborn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plotting_bokeh.html">
   Bokeh
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plotting_holoviews.html">
   Holoviews
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="widgets.html">
   Widgets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="interactive_apps.html">
   Interactive Application
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Numpy and Pandas
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="numpy_module.html">
   Numpy Module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vapor_pressure_deficit.html">
   Vapor Pressure Deficit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="photoperiod_numpy_module.html">
   Photoperiod
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Pandas Module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="import_tabular_data.html">
   Import Tabular Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="handy_functions.html">
   Handy functions for data science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="precipitation_distribution.html">
   Precipitation Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bird_counts.html">
   Exploring Bird Counts with Pandas and HoloViews
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Web data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="url_ks_mesonet.html">
   Kansas Mesonet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="url_ok_mesonet.html">
   Oklahoma Mesonet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="url_uscrn.html">
   Climate Reference Network
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="url_nasa_api.html">
   Open NASA APIs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coronavirus.html">
   Coronavirus COVID-19 Timeseries of Global Cases
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statistics and curve fitting
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="statistics_module.html">
   Statistics module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="error_metrics.html">
   Error Metrics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="anova.html">
   Analysis of Variance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="group_least_variance.html">
   Group with the Least Variance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats_linear_regression.html">
   Linear Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sensor_calibration.html">
   Linear Regression: Sensor Calibration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="neutron_probe_calibration.html">
   Calibration of a Neutron Probe
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="anscombe_quartet.html">
   Anscombe’s Quartet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_respiration.html">
   Soil Respiration Rate
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optimal_nitrogen_rate.html">
   Optimal Nitrogen Rate
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="maximum_return_to_nitrogen.html">
   Maximum Return to Nitrogen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="proctor_test.html">
   Proctor test
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cdf_matching.html">
   CDF Matching Function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats_multiple_linear_regression.html">
   Multiple Linear Regression Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="frontier_function.html">
   Frontier Production Function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats_curve_fitting_exp.html">
   Curve Fitting: Exponential Decay
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cosmos_calibration.html">
   Neutron Counts to Volumetric Water Content
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats_curve_fitting_wave.html">
   Curve Fitting: Sinusoid
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_water_retention_curve.html">
   Soil Water Retention Curve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="atmospheric_carbon_dioxide.html">
   Atmospheric Carbon Dioxide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="birthday_paradox.html">
   Birthday Paradox
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="neural_network_regression.html">
   Neural Network Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="neural_network_classification.html">
   Neural Network Classification
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Problems in 1D
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="fill_missing_data.html">
   Fill Missing Soil Moisture Timeseries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="denoise_passive_neutron_counts.html">
   Denoising Cosmic-Ray Neutron Signal
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wheat_potential_biomass.html">
   Modeling Wheat Biomass
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wheat_phenology.html">
   Wheat phenology model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_chain.html">
   Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="antecedent_precipitation_index.html">
   Antecedent Precipitation Index
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_chain_soil_moisture.html">
   Modeling Soil Moisture
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rainfall_generator.html">
   Rainfall Generator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="precipitation_metrics.html">
   Precipitation Metrics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="atmospheric_water_deficit.html">
   Atmospheric Water Deficit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="drydowns_from_timeseries.html">
   Soil Moisture Drydowns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="air_temperature.html">
   Air Temperature
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="solar_radiation.html">
   Solar Radiation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_temperature.html">
   Understanding Soil Temperature
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_temperature_model.html">
   Soil Temperature Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_water_storage.html">
   Soil Water Storage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exponential_filter.html">
   Rootzone Soil Water from Surface Observations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plant_available_water.html">
   Plant Available Water
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mixing_model.html">
   Mixing Solute Problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newton_law_cooling.html">
   Newton’s law of cooling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lotka_volterra.html">
   Lotka-Volterra: Predator–Prey Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="leaky_bucket.html">
   Leaky buckets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="thermal_time.html">
   Thermal Units
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="root_depth.html">
   Root growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_water_balance.html">
   Soil Water Balance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="evaporation.html">
   Soil Evaporation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="evapotranspiration.html">
   Potential Evapotranspiration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="curve_number.html">
   Runoff
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Image analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="canopeo.html">
   Green Canopy Cover
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="count_seeds.html">
   Counting seeds
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="segmented_lake.html">
   Patch analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_cracks_detection.html">
   Soil Cracks
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Mapping
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="nearest_station.html">
   Find Nearest Monitoring Station
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inverse_distance_weighting.html">
   Inverse Distance Weighting Interpolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="interpolation.html">
   Spatial Interpolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="raster_nasa_worldview.html">
   Rasters from NASA Worldview Snapshots
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="land_cover.html">
   Land Cover Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="denoise_yield_monitor.html">
   Denoise Yield Monitor Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="raster_change_crs.html">
   Change Coordinate Reference System
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="field_random_samples.html">
   Field Random Samples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="euclidean_distance.html">
   Efficient Euclidean Distance
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Numerical problems 2D
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="game_of_life.html">
   Conway’s Game of Life
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wildfire_spread.html">
   Wildfire Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reaction_diffusion.html">
   Gray-Scott Model of Reaction-Diffusion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="disease_spread.html">
   Disease Spread
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Clustering
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="clustering_environments.html">
   Environmental Agroregions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="soil_water_deficit_classification.html">
   Clustering Time Series
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="field_management_zones.html">
   Field Management Zones
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Symbolic math
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="sympy_module.html">
   Sympy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="logistic_growth.html">
   Logistic Growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="population_growth.html">
   Population Growth
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/pandas_module.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/soilwater/pynotes-agriscience"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/soilwater/pynotes-agriscience/master?urlpath=tree/notebooks/pandas_module.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-dataframe-from-existing-variable">
   Create DataFrame from existing variable
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-methods-and-properties">
   Basic methods and properties
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#convert-strings-to-datetime">
   Convert strings to datetime
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extract-information-from-the-timestamp">
   Extract information from the timestamp
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#missing-values">
   Missing values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quick-statistics">
   Quick statistics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#indexing-and-slicing">
   Indexing and slicing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-index-operator">
     Using index operator
     <code class="docutils literal notranslate">
      <span class="pre">
       []
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#select-rows">
   Select rows
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#select-columns">
   Select columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#slicing-rows-and-columns">
   Slicing rows and columns
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-iloc-method">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       iloc
      </span>
     </code>
     method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-loc-method">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       loc
      </span>
     </code>
     method
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#filter-data-using-boolean-indexing">
   Filter data using boolean indexing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pandas-custom-date-range">
   Pandas custom date range
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#select-range-of-dates-with-boolean-indexing">
   Select range of dates with boolean indexing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-and-remove-columns">
   Add and remove columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reset-dataframe-index">
   Reset DataFrame index
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merge-two-dataframes">
   Merge two dataframes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pandas-numpy">
   Pandas &lt;-&gt; Numpy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#operations-with-real-dataset">
   Operations with  real dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#match-specific-stations">
     Match specific stations
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Pandas Module</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-dataframe-from-existing-variable">
   Create DataFrame from existing variable
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-methods-and-properties">
   Basic methods and properties
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#convert-strings-to-datetime">
   Convert strings to datetime
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extract-information-from-the-timestamp">
   Extract information from the timestamp
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#missing-values">
   Missing values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quick-statistics">
   Quick statistics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#indexing-and-slicing">
   Indexing and slicing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-index-operator">
     Using index operator
     <code class="docutils literal notranslate">
      <span class="pre">
       []
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#select-rows">
   Select rows
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#select-columns">
   Select columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#slicing-rows-and-columns">
   Slicing rows and columns
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-iloc-method">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       iloc
      </span>
     </code>
     method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-loc-method">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       loc
      </span>
     </code>
     method
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#filter-data-using-boolean-indexing">
   Filter data using boolean indexing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pandas-custom-date-range">
   Pandas custom date range
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#select-range-of-dates-with-boolean-indexing">
   Select range of dates with boolean indexing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-and-remove-columns">
   Add and remove columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reset-dataframe-index">
   Reset DataFrame index
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merge-two-dataframes">
   Merge two dataframes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pandas-numpy">
   Pandas &lt;-&gt; Numpy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#operations-with-real-dataset">
   Operations with  real dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#match-specific-stations">
     Match specific stations
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="pandas-module">
<h1>Pandas Module<a class="headerlink" href="#pandas-module" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Pandas is built on top of Numpy and is the most popular Python library for handling tabular data. The library is powerful and extensive, so here we will cover some of the basic features. The most popular module of the <strong>Pandas</strong> library is probably <em>DataFrames</em>. We will learn how to create a daframe, retrieve data, replace missing values, and compute simple statistics.</p>
<p>The concept of the <strong>Pandas</strong> library is that we can call data stored in rows or columns by name. This allows us to handle data without having to remember the exact location of a column.</p>
<p>Pandas DataFrame excels at loading tabular data from comma-separated value files (.csv) and text files (.txt). Files typically have a single line of column headers and each column has the same data type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import modules</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-dataframe-from-existing-variable">
<h2>Create DataFrame from existing variable<a class="headerlink" href="#create-dataframe-from-existing-variable" title="Permalink to this headline">¶</a></h2>
<p>After importing the module we have two possible directions. We import data from a file or we convert an existing variable into a Pandas DataFrame. Here we will create a simple DatFrame to learn the basics. This way we will be able to display the result of our operations without worrying about extensive datasets.</p>
<p>Let’s create a dictionary with some weather data and missing values (represented by <code class="docutils literal notranslate"><span class="pre">-9999</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create dictionary with some weather data</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;1/1/2000&#39;</span><span class="p">,</span><span class="s1">&#39;2/1/2000&#39;</span><span class="p">,</span><span class="s1">&#39;3/1/2000&#39;</span><span class="p">,</span><span class="s1">&#39;4/1/2000&#39;</span><span class="p">,</span><span class="s1">&#39;5/1/2000&#39;</span><span class="p">],</span> 
        <span class="s1">&#39;windSpeed&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">9999.0</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">],</span> 
        <span class="s1">&#39;windDirection&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;NW&#39;</span><span class="p">,</span> <span class="s1">&#39;NW&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">],</span>
        <span class="s1">&#39;precipitation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}</span>
</pre></div>
</div>
</div>
</div>
<p>The next step consists of converting the dictionary into a Pandas DataFrame. This is straight forward using the DataFrame method of the Pandas modules <code class="docutils literal notranslate"><span class="pre">pd.DataFrame()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert dictionary into DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1/1/2000</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2/1/2000</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3/1/2000</td>
      <td>-9999.0</td>
      <td>NW</td>
      <td>25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4/1/2000</td>
      <td>4.1</td>
      <td>N</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5/1/2000</td>
      <td>2.9</td>
      <td>S</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p>To display the DataFrame content simply use the <code class="docutils literal notranslate"><span class="pre">head()</span></code> and <code class="docutils literal notranslate"><span class="pre">tail()</span></code> methods.
As an alternative you can use the <code class="docutils literal notranslate"><span class="pre">print()</span></code> function or type the name of the DataFrame and hit <code class="docutils literal notranslate"><span class="pre">ctrl</span> <span class="pre">+</span> <span class="pre">Enter</span></code>. Note that by default Jupyter Lab highlights the different table rows when using the second option, so for readability purposes I will use the second option from now on.</p>
</div></blockquote>
<p>Dissecting the DataFrame above we find the following main components:</p>
<ol class="simple">
<li><p>header row containing column names</p></li>
<li><p>index (the left-most column with numbers from 0 to 4) is equivalent to a row name.</p></li>
<li><p>Each column has data of the same type.</p></li>
</ol>
</div>
<div class="section" id="basic-methods-and-properties">
<h2>Basic methods and properties<a class="headerlink" href="#basic-methods-and-properties" title="Permalink to this headline">¶</a></h2>
<p>Pandas DataFrame has dedicated functions to display a limited number of heading and tailing rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># First three rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1/1/2000</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2/1/2000</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3/1/2000</td>
      <td>-9999.0</td>
      <td>NW</td>
      <td>25</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># Last three rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3/1/2000</td>
      <td>-9999.0</td>
      <td>NW</td>
      <td>25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4/1/2000</td>
      <td>4.1</td>
      <td>N</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5/1/2000</td>
      <td>2.9</td>
      <td>S</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To start handling our data we need to learn how to retrieve data from the Pandas DataFrame. If we don’t know the column names of the dataset we can print them using the column property. We can also inspect the data type of each column as well as its total number of elements and shape.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>  <span class="c1"># Column names</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;timestamp&#39;, &#39;windSpeed&#39;, &#39;windDirection&#39;, &#39;precipitation&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">size</span>  <span class="c1"># Total number of elements</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Number of rows and columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5, 4)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>  <span class="c1"># Data type for each column</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>timestamp         object
windSpeed        float64
windDirection     object
precipitation      int64
dtype: object
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="convert-strings-to-datetime">
<h2>Convert strings to datetime<a class="headerlink" href="#convert-strings-to-datetime" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert dates in string format to Pandas datetime format</span>
<span class="c1"># %d = day in format 00 days</span>
<span class="c1"># %m = month in format 00 months</span>
<span class="c1"># %Y = full year</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-02</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-03</td>
      <td>-9999.0</td>
      <td>NW</td>
      <td>25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-04</td>
      <td>4.1</td>
      <td>N</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-05</td>
      <td>2.9</td>
      <td>S</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that the format of our `timestamp` column change to datetime format</span>
<span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>timestamp        datetime64[ns]
windSpeed               float64
windDirection            object
precipitation             int64
dtype: object
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="extract-information-from-the-timestamp">
<h2>Extract information from the timestamp<a class="headerlink" href="#extract-information-from-the-timestamp" title="Permalink to this headline">¶</a></h2>
<p>Here we can obtain the day, month, year, and even other components such hours, minutes and nanoseconds fromt he timestamp. Having a separate column for some of these components can be extremely helpful in case we want to aggregate data. For instnance, to compute the monthly mean air temperature we need to know in what month each temperature record was obtained.</p>
<p>For this we will use the <code class="docutils literal notranslate"><span class="pre">dt</span></code> submodule within <code class="docutils literal notranslate"><span class="pre">Pandas</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the day of the year</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;doy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofyear</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-02</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-03</td>
      <td>-9999.0</td>
      <td>NW</td>
      <td>25</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-04</td>
      <td>4.1</td>
      <td>N</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-05</td>
      <td>2.9</td>
      <td>S</td>
      <td>0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p>Note that the new column was placed at the end. This the default when creating a new column.</p>
</div></blockquote>
<p>The next example makes use of the <code class="docutils literal notranslate"><span class="pre">insert()</span></code> method to add the new column on a specific location. Typically for dates and date components we want to have the columns at the beginning, close to the datetime. For other variables the previous approach that appends the new column at the end of the DataFrame will work just fine.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get month from timstamp and create new column</span>

<span class="c1">#.insert(positionOfNewColumn, nameOfNewColumn, dataOfNewColumn)</span>

<span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>1</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-02</td>
      <td>1</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-03</td>
      <td>1</td>
      <td>-9999.0</td>
      <td>NW</td>
      <td>25</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-04</td>
      <td>1</td>
      <td>4.1</td>
      <td>N</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-05</td>
      <td>1</td>
      <td>2.9</td>
      <td>S</td>
      <td>0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p>If you re-run the previous cell you will get an error since Pandas prevents having two columns with the same name.</p>
</div></blockquote>
</div>
<div class="section" id="missing-values">
<h2>Missing values<a class="headerlink" href="#missing-values" title="Permalink to this headline">¶</a></h2>
<p>One of the most common operations when working with data is to handle missing values. Almost every dataset has missing data and there is no universal way of denoting missing values. Most common placeholders are: <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, <code class="docutils literal notranslate"><span class="pre">NA</span></code>, <code class="docutils literal notranslate"><span class="pre">-99</span></code>, <code class="docutils literal notranslate"><span class="pre">-9999</span></code>, <code class="docutils literal notranslate"><span class="pre">missing</span></code>. To find out more about how missing data is represented in your dataset read associated documentation files.</p>
<p>I typically prefer to use <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (personal preference since I also use Matlab frequently). In many datasets missing data may already by imported as NaN or NA, meaning that you can directly use the <code class="docutils literal notranslate"><span class="pre">fillna()</span></code> method without this intermediary step.</p>
<p>To replace missing values we will follow these steps:</p>
<ol class="simple">
<li><p>Identify the cells with <code class="docutils literal notranslate"><span class="pre">-9999</span></code> values. Output will be a logical DataFrame having the same dimensions as <code class="docutils literal notranslate"><span class="pre">df</span></code>.</p></li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">-9999</span></code> with <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values. Note that I’m using <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values from <strong>Numpy</strong>.</p></li>
<li><p>Check our work using the <code class="docutils literal notranslate"><span class="pre">isna()</span></code> method (optional)</p></li>
</ol>
<blockquote>
<div><p>Pandas offers a machinery to deal with missing data, meaning that it is not necessary to replace these values in order to make computations with the data. We just need to ensure that missing values are in the right format. In some cases an option would be to replace missing data with an estimate value, like using the average of the values immediately above and below or using the average for the entire data (not ideal)using the <code class="docutils literal notranslate"><span class="pre">fillna()</span></code> method. For instance: <code class="docutils literal notranslate"><span class="pre">df.fillna(df.windSpeed.mean())</span></code></p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 1: find -9999 values across the entire dataframe</span>

<span class="n">idx_missing</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="o">-</span><span class="mi">9999</span><span class="p">])</span>
<span class="n">idx_missing</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find missing vlaues in only one column</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;windSpeed&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">9999</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1    False
2     True
3    False
4    False
Name: windSpeed, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 2: Replace missing values with NaN</span>

<span class="n">df</span><span class="p">[</span><span class="n">idx_missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>1</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-02</td>
      <td>1</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-03</td>
      <td>1</td>
      <td>NaN</td>
      <td>NW</td>
      <td>25</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-04</td>
      <td>1</td>
      <td>4.1</td>
      <td>N</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-05</td>
      <td>1</td>
      <td>2.9</td>
      <td>S</td>
      <td>0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NaNs are of type float</span>
<span class="nb">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>float
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 3: Check our work</span>
<span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="quick-statistics">
<h2>Quick statistics<a class="headerlink" href="#quick-statistics" title="Permalink to this headline">¶</a></h2>
<p>DataFrames have a variety of methods to calculate simple statistics. To obtain an overall summary we can use the <code class="docutils literal notranslate"><span class="pre">describe()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Summary stats for all columns</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       month  windSpeed  precipitation       doy
count    5.0   4.000000         5.0000  5.000000
mean     1.0   3.100000         9.0000  3.000000
std      0.0   0.787401        11.7047  1.581139
min      1.0   2.200000         0.0000  1.000000
25%      1.0   2.725000         0.0000  2.000000
50%      1.0   3.050000         2.0000  3.000000
75%      1.0   3.425000        18.0000  4.000000
max      1.0   4.100000        25.0000  5.000000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Metric ignoring NaN values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;windSpeed&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>         <span class="c1"># Maximum value for each column</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;windSpeed&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>        <span class="c1"># Average value for each column</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;windSpeed&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>         <span class="c1"># Minimum value for each column</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;windSpeed&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>         <span class="c1"># Standard deviation value for each column</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;windSpeed&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>         <span class="c1"># Variance value for each column</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;windSpeed&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>      <span class="c1"># Variance value for each column</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;windSpeed&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.95</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.1
3.1
2.2
0.7874007874011809
0.6199999999999997
3.05
3.9649999999999994
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cumulative sum. Useful to compute cumulative precipitation</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">precipitation</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     0
1    18
2    43
3    45
4    45
Name: precipitation, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unique values. Useful to compute unique wind directions</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">windDirection</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;E&#39; &#39;NW&#39; &#39;N&#39; &#39;S&#39;]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="indexing-and-slicing">
<h2>Indexing and slicing<a class="headerlink" href="#indexing-and-slicing" title="Permalink to this headline">¶</a></h2>
<div class="section" id="using-index-operator">
<h3>Using index operator <code class="docutils literal notranslate"><span class="pre">[]</span></code><a class="headerlink" href="#using-index-operator" title="Permalink to this headline">¶</a></h3>
<p>To start making computations with need to access the data insde the Pandas DataFrame. Indexing and slicing are useful operations to select portions of data by calling specific rows, columns, or a combination of both. The index operator <code class="docutils literal notranslate"><span class="pre">[]</span></code> is primarily intended to be used with column labels (e.g. <code class="docutils literal notranslate"><span class="pre">df[columnName]</span></code>), however, it can also handle row slices (e.g. <code class="docutils literal notranslate"><span class="pre">df[rows]</span></code>). A common notation useful to understand how the slicing works is as follows:</p>
</div>
</div>
<div class="section" id="select-rows">
<h2>Select rows<a class="headerlink" href="#select-rows" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># First three rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>1</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-02</td>
      <td>1</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-03</td>
      <td>1</td>
      <td>NaN</td>
      <td>NW</td>
      <td>25</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="select-columns">
<h2>Select columns<a class="headerlink" href="#select-columns" title="Permalink to this headline">¶</a></h2>
<p>We can call individual columns using the <code class="docutils literal notranslate"><span class="pre">dot</span></code> or <code class="docutils literal notranslate"><span class="pre">bracket</span></code> notation. Note that in option 2 there is no <code class="docutils literal notranslate"><span class="pre">.</span></code> between <code class="docutils literal notranslate"><span class="pre">df</span></code> and <code class="docutils literal notranslate"><span class="pre">['windSpeed']</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">windSpeed</span>    <span class="c1"># Option 1</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;windSpeed&#39;</span><span class="p">]</span> <span class="c1"># Option 2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2.2
1    3.2
2    NaN
3    4.1
4    2.9
Name: windSpeed, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>To pass more than one row of column you will need to group them in a list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select multiple columns at once</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;windSpeed&#39;</span><span class="p">,</span><span class="s1">&#39;windDirection&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>windSpeed</th>
      <th>windDirection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.2</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.2</td>
      <td>NW</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NW</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.1</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.9</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A common mistake when slicing multiple columns is to forget grouping column names into a list, so the following command will not work:</p>
<p><code class="docutils literal notranslate"><span class="pre">df['windSpeed','windDirection']</span></code></p>
</div>
<div class="section" id="slicing-rows-and-columns">
<h2>Slicing rows and columns<a class="headerlink" href="#slicing-rows-and-columns" title="Permalink to this headline">¶</a></h2>
<div class="section" id="using-iloc-method">
<h3>Using <code class="docutils literal notranslate"><span class="pre">iloc</span></code> method<a class="headerlink" href="#using-iloc-method" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">iloc</span></code>: Integer-location. <code class="docutils literal notranslate"><span class="pre">iloc</span></code> gets rows (or columns) at specific indexes. It only takes integers as input. <strong>Exclusive of its endpoint</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Top 3 rows and columns 1 and 2</span>
<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>month</th>
      <th>windSpeed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>3.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Top 2 rows and all columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,:]</span> <span class="c1"># Same as: df.iloc[0:2]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>1</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-02</td>
      <td>1</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Although a bit more verbose and perhaps less <em>pythonic</em>, I prefer to specify <code class="docutils literal notranslate"><span class="pre">all</span> <span class="pre">the</span> <span class="pre">columns</span></code> using the <code class="docutils literal notranslate"><span class="pre">:</span></code> character. In my opinion this notation is more explicit and clearly states the rows and columns of the slicing operation. So, <code class="docutils literal notranslate"><span class="pre">df.iloc[0:2,:]</span></code> is preferred over <code class="docutils literal notranslate"><span class="pre">df.iloc[0:2]</span></code>.</p>
</div>
<div class="section" id="using-loc-method">
<h3>Using <code class="docutils literal notranslate"><span class="pre">loc</span></code> method<a class="headerlink" href="#using-loc-method" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">loc</span></code> gets rows (or columns) with specific labels. <strong>Inclusive of its endpoint</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select multiple rows and columns at once using the loc method</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,[</span><span class="s1">&#39;windSpeed&#39;</span><span class="p">,</span><span class="s1">&#39;windDirection&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>windSpeed</th>
      <th>windDirection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.2</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.2</td>
      <td>NW</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NW</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Some rows and all columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>1</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-02</td>
      <td>1</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First three elements of a single column</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;windSpeed&#39;</span><span class="p">]</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2.2
1    3.2
2    NaN
Name: windSpeed, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First three elements of multiple columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,[</span><span class="s1">&#39;windSpeed&#39;</span><span class="p">,</span><span class="s1">&#39;windDirection&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>windSpeed</th>
      <th>windDirection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.2</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.2</td>
      <td>NW</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NW</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>These statements will not work with <code class="docutils literal notranslate"><span class="pre">loc</span></code>:</p>
<p><code class="docutils literal notranslate"><span class="pre">df.loc[0:2,0:1]</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">df.loc[[0:2],[0:1]]</span></code></p>
</div>
</div>
<div class="section" id="filter-data-using-boolean-indexing">
<h2>Filter data using boolean indexing<a class="headerlink" href="#filter-data-using-boolean-indexing" title="Permalink to this headline">¶</a></h2>
<p>Boolean indexing (a.k.a. logical indexing) consists of creating a boolean array with True/False values as a consequence of conditional statement that can be use to select the rows that meet the specified condition. Logical indexing are often not intuitive for students learning how to program, but are incredibly powerful and I highly encourage its use.</p>
<p>Let’s select all the data for days that have wind speed greater than 3 meters per second. We will first select the rows of <code class="docutils literal notranslate"><span class="pre">df.windSpeed</span></code> that are greater than 3 m/s, and then we will use the resulting boolean to slice the DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">windSpeed</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="c1"># Rows in which the wind speed is greater than </span>
<span class="n">idx</span>  <span class="c1"># Let&#39;s inspect the idx variable.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1     True
2    False
3     True
4    False
Name: windSpeed, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now let&#39;s apply the boolean variable to the dataframe</span>
<span class="n">df</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2000-01-02</td>
      <td>1</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-04</td>
      <td>1</td>
      <td>4.1</td>
      <td>N</td>
      <td>2</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can also apply the boolean to specific columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="s1">&#39;windDirection&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    NW
3     N
Name: windDirection, dtype: object
</pre></div>
</div>
</div>
</div>
<p>It’s also possible to write the previous command with the conditional statement in a single line of code. This is fine to do, but sometimes nesting too many conditions can create commands that are hard to understand. I typically recommend storing the boolean results in a new variable that is easier to pass around. This is particularly helpful if you are planning to re-use the boolean in multiple lines of you code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Same in a single line of code</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">windSpeed</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">,</span><span class="s1">&#39;windDirection&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    NW
3     N
Name: windDirection, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Another popular way of filtering is to check whether an element or group of elements are within a set. If you come from Matlab the following example is similar to the <code class="docutils literal notranslate"><span class="pre">ismember()</span></code> function.</p>
<p>Let’s check whether January 1 and January 2 are in the dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_doy</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;doy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>  <span class="c1">#list(range(1,5))</span>
<span class="n">idx_doy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     True
1     True
2    False
3    False
4    False
Name: doy, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx_doy</span><span class="p">,:]</span> <span class="c1"># Select all columns for the selected days of the year</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>1</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-02</td>
      <td>1</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="pandas-custom-date-range">
<h2>Pandas custom date range<a class="headerlink" href="#pandas-custom-date-range" title="Permalink to this headline">¶</a></h2>
<p>In this particular case we have the day of the year to indicate time, however, in many occasions is better to handle dates. Often times dates are already present in the dataset, but if they aren’t then we can create and handle dates with Pandas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset_dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20000102&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span> <span class="c1"># Used df.shape[0] to find the total number of rows</span>
<span class="n">subset_dates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2000-01-02&#39;, &#39;2000-01-03&#39;], dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The same to generate months</span>
<span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20200101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span> <span class="c1"># Specify the frequency to months</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2020-01-31&#39;, &#39;2020-02-29&#39;, &#39;2020-03-31&#39;, &#39;2020-04-30&#39;,
               &#39;2020-05-31&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;M&#39;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="select-range-of-dates-with-boolean-indexing">
<h2>Select range of dates with boolean indexing<a class="headerlink" href="#select-range-of-dates-with-boolean-indexing" title="Permalink to this headline">¶</a></h2>
<p>Now that we covered both boolean indexing and pandas dates we can use these concepts to select data from a specific window of time. This is a pretty common operation when trying to select a subset of the entire DataFrame by a specific date range.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate boolean for rows that match the subset of dates generated earlier</span>
<span class="n">idx_subset</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">subset_dates</span><span class="p">)</span>
<span class="n">idx_subset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1     True
2     True
3    False
4    False
Name: timestamp, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate a new DataFrame using only the rows with matching dates</span>
<span class="n">df_subset</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx_subset</span><span class="p">]</span>
<span class="n">df_subset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2000-01-02</td>
      <td>1</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-03</td>
      <td>1</td>
      <td>NaN</td>
      <td>NW</td>
      <td>25</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># It isn&#39;t always necessary to generate a new DataFrame</span>
<span class="c1"># So you can access a specific column like this</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx_subset</span><span class="p">,</span><span class="s2">&quot;precipitation&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    18
2    25
Name: precipitation, dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-and-remove-columns">
<h2>Add and remove columns<a class="headerlink" href="#add-and-remove-columns" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">insert()</span></code> and <code class="docutils literal notranslate"><span class="pre">drop()</span></code> methods allow us to add or remove columns to/from the DataFrame. The most common use of these functions is as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">df.insert(indexOfNewColumn,</span> <span class="pre">nameOfNewColumn,</span> <span class="pre">dataArrayOfNewColumn)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">df.drop(nameOfColumnToBeRemoved)</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add new column at a specific location</span>
<span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;airTemperature&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">25.4</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mf">27.1</span><span class="p">,</span> <span class="mf">28.9</span><span class="p">,</span> <span class="mf">30.2</span><span class="p">])</span> <span class="c1"># Similar to: df[&#39;dates&#39;] = dates</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>airTemperature</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>1</td>
      <td>25.4</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-02</td>
      <td>1</td>
      <td>26.0</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-03</td>
      <td>1</td>
      <td>27.1</td>
      <td>NaN</td>
      <td>NW</td>
      <td>25</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-04</td>
      <td>1</td>
      <td>28.9</td>
      <td>4.1</td>
      <td>N</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-05</td>
      <td>1</td>
      <td>30.2</td>
      <td>2.9</td>
      <td>S</td>
      <td>0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove specific column</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;airTemperature&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>1</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-02</td>
      <td>1</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-03</td>
      <td>1</td>
      <td>NaN</td>
      <td>NW</td>
      <td>25</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-04</td>
      <td>1</td>
      <td>4.1</td>
      <td>N</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-05</td>
      <td>1</td>
      <td>2.9</td>
      <td>S</td>
      <td>0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="reset-dataframe-index">
<h2>Reset DataFrame index<a class="headerlink" href="#reset-dataframe-index" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Replace the index by a variables of our choice</span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;doy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>airTemperature</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
    </tr>
    <tr>
      <th>doy</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2000-01-01</td>
      <td>1</td>
      <td>25.4</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-02</td>
      <td>1</td>
      <td>26.0</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-03</td>
      <td>1</td>
      <td>27.1</td>
      <td>NaN</td>
      <td>NW</td>
      <td>25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-04</td>
      <td>1</td>
      <td>28.9</td>
      <td>4.1</td>
      <td>N</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2000-01-05</td>
      <td>1</td>
      <td>30.2</td>
      <td>2.9</td>
      <td>S</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reset the index (see that &#39;doy&#39; goes back to the end of the DataFrame again)</span>
<span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>timestamp</th>
      <th>month</th>
      <th>airTemperature</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2000-01-01</td>
      <td>1</td>
      <td>25.4</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2000-01-02</td>
      <td>1</td>
      <td>26.0</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2000-01-03</td>
      <td>1</td>
      <td>27.1</td>
      <td>NaN</td>
      <td>NW</td>
      <td>25</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2000-01-04</td>
      <td>1</td>
      <td>28.9</td>
      <td>4.1</td>
      <td>N</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2000-01-05</td>
      <td>1</td>
      <td>30.2</td>
      <td>2.9</td>
      <td>S</td>
      <td>0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="merge-two-dataframes">
<h2>Merge two dataframes<a class="headerlink" href="#merge-two-dataframes" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new DataFrame (follows dates)</span>

<span class="c1"># Dictionary</span>
<span class="n">data2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;6/1/2000&#39;</span><span class="p">,</span><span class="s1">&#39;7/1/2000&#39;</span><span class="p">,</span><span class="s1">&#39;8/1/2000&#39;</span><span class="p">,</span><span class="s1">&#39;9/1/2000&#39;</span><span class="p">,</span><span class="s1">&#39;10/1/2000&#39;</span><span class="p">],</span> 
        <span class="s1">&#39;windSpeed&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.3</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">],</span> 
        <span class="s1">&#39;windDirection&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;SW&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;NW&#39;</span><span class="p">],</span>
        <span class="s1">&#39;precipitation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}</span>

<span class="c1"># Dcitionary to DataFrame</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>

<span class="c1"># Convert strings to pandas datetime</span>
<span class="n">df2</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">)</span> 

<span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-06</td>
      <td>4.3</td>
      <td>N</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-07</td>
      <td>2.1</td>
      <td>N</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-08</td>
      <td>0.5</td>
      <td>SW</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-09</td>
      <td>2.7</td>
      <td>E</td>
      <td>25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-10</td>
      <td>1.9</td>
      <td>NW</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p>Not using the <code class="docutils literal notranslate"><span class="pre">format=&quot;%d/%m/%y&quot;</span></code> in the previous cell results in the wrong datetime conversion. It is always recommended to specify the format.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="n">df_merged</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>airTemperature</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>1.0</td>
      <td>25.4</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-02</td>
      <td>1.0</td>
      <td>26.0</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-03</td>
      <td>1.0</td>
      <td>27.1</td>
      <td>NaN</td>
      <td>NW</td>
      <td>25</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-04</td>
      <td>1.0</td>
      <td>28.9</td>
      <td>4.1</td>
      <td>N</td>
      <td>2</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-05</td>
      <td>1.0</td>
      <td>30.2</td>
      <td>2.9</td>
      <td>S</td>
      <td>0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2000-01-06</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.3</td>
      <td>N</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-07</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.1</td>
      <td>N</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-08</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.5</td>
      <td>SW</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-09</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.7</td>
      <td>E</td>
      <td>25</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.9</td>
      <td>NW</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p>Note how <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values were assigned to variables not present in the new DataFrame</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create another DataFrame with more limited data. Values every other day</span>
<span class="n">data3</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;1/1/2000&#39;</span><span class="p">,</span><span class="s1">&#39;3/1/2000&#39;</span><span class="p">,</span><span class="s1">&#39;5/1/2000&#39;</span><span class="p">,</span><span class="s1">&#39;7/1/2000&#39;</span><span class="p">,</span><span class="s1">&#39;9/1/2000&#39;</span><span class="p">],</span> 
         <span class="s1">&#39;pressure&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">980</span><span class="p">,</span> <span class="mi">987</span><span class="p">,</span> <span class="mi">985</span><span class="p">,</span> <span class="mi">991</span><span class="p">,</span> <span class="mi">990</span><span class="p">]}</span>  <span class="c1"># Pressure in millibars</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data3</span><span class="p">)</span>
<span class="n">df3</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df3</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">)</span>
<span class="n">df3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>pressure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>980</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-03</td>
      <td>987</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-05</td>
      <td>985</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-07</td>
      <td>991</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-09</td>
      <td>990</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Only the matching rows will be merged</span>
<span class="n">df_merged</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>airTemperature</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
      <th>pressure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>1.0</td>
      <td>25.4</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
      <td>1.0</td>
      <td>980</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-03</td>
      <td>1.0</td>
      <td>27.1</td>
      <td>NaN</td>
      <td>NW</td>
      <td>25</td>
      <td>3.0</td>
      <td>987</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-05</td>
      <td>1.0</td>
      <td>30.2</td>
      <td>2.9</td>
      <td>S</td>
      <td>0</td>
      <td>5.0</td>
      <td>985</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-07</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.1</td>
      <td>N</td>
      <td>0</td>
      <td>NaN</td>
      <td>991</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-09</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.7</td>
      <td>E</td>
      <td>25</td>
      <td>NaN</td>
      <td>990</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Only add values from the new, more sporadic, variable where there is a match.</span>
<span class="n">df_merged</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>month</th>
      <th>airTemperature</th>
      <th>windSpeed</th>
      <th>windDirection</th>
      <th>precipitation</th>
      <th>doy</th>
      <th>pressure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>1.0</td>
      <td>25.4</td>
      <td>2.2</td>
      <td>E</td>
      <td>0</td>
      <td>1.0</td>
      <td>980.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-02</td>
      <td>1.0</td>
      <td>26.0</td>
      <td>3.2</td>
      <td>NW</td>
      <td>18</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-03</td>
      <td>1.0</td>
      <td>27.1</td>
      <td>NaN</td>
      <td>NW</td>
      <td>25</td>
      <td>3.0</td>
      <td>987.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-04</td>
      <td>1.0</td>
      <td>28.9</td>
      <td>4.1</td>
      <td>N</td>
      <td>2</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-05</td>
      <td>1.0</td>
      <td>30.2</td>
      <td>2.9</td>
      <td>S</td>
      <td>0</td>
      <td>5.0</td>
      <td>985.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2000-01-06</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.3</td>
      <td>N</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2000-01-07</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.1</td>
      <td>N</td>
      <td>0</td>
      <td>NaN</td>
      <td>991.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2000-01-08</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.5</td>
      <td>SW</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2000-01-09</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.7</td>
      <td>E</td>
      <td>25</td>
      <td>NaN</td>
      <td>990.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2000-01-10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.9</td>
      <td>NW</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="pandas-numpy">
<h2>Pandas &lt;-&gt; Numpy<a class="headerlink" href="#pandas-numpy" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get numpy values from Pandas series</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;windSpeed&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2.2, 3.2, nan, 4.1, 2.9])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Confirm the data type is Numpy array</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;windSpeed&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;numpy.ndarray&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 

<span class="c1"># Create some synthetic data</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20200101&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">365</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span> <span class="c1"># 3 years of synthetic data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">x</span><span class="o">/</span><span class="mi">365</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>  <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><span class="o">*</span><span class="mf">0.2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">doy</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy.ndarray
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert data to Numpy array, where each variable is a column</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dates</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="n">A</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2, 1095)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transpose data so that days are along the rows and the variables along the columns</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">A</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1095, 2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create DataFrame</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">A</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dates&quot;</span><span class="p">,</span><span class="s2">&quot;y&quot;</span><span class="p">])</span>
<span class="n">df4</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dates</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-01-01</td>
      <td>0.342082</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-01-02</td>
      <td>-0.0879297</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-01-03</td>
      <td>-0.0540147</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-01-04</td>
      <td>-0.145791</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-01-05</td>
      <td>0.259046</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To convert a single numpy array into Pandas series just use:</span>
<span class="n">ypd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ypd</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.series.Series&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df4</span><span class="p">[</span><span class="s2">&quot;dates&quot;</span><span class="p">],</span><span class="n">df4</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Random Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/pandas_module_94_0.png" src="../_images/pandas_module_94_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Moving average</span>
<span class="n">ypd_smooth_forward</span> <span class="o">=</span> <span class="n">df4</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">ypd_smooth_center</span> <span class="o">=</span> <span class="n">df4</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>In case you are just using a Pandas series converted previously (<code class="docutils literal notranslate"><span class="pre">ypd</span></code>), you can perform the same computation as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ypd</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show differences in forward and centered moving averages</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df4</span><span class="p">[</span><span class="s2">&quot;dates&quot;</span><span class="p">],</span><span class="n">df4</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])</span>

<span class="c1"># Add the moving averages. We did not add the computed moving averages to our DataFrame,</span>
<span class="c1"># so we just need to call the variables</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df4</span><span class="p">[</span><span class="s2">&quot;dates&quot;</span><span class="p">],</span><span class="n">ypd_smooth_forward</span><span class="p">,</span> <span class="s1">&#39;--k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forward moving average&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df4</span><span class="p">[</span><span class="s2">&quot;dates&quot;</span><span class="p">],</span><span class="n">ypd_smooth_center</span><span class="p">,</span> <span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Center moving average&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/pandas_module_97_0.png" src="../_images/pandas_module_97_0.png" />
</div>
</div>
<p>In this case, the selection of a forward or centered moving average affects the timing of maximum and minimum values of the wave. A centered moving average is ideal to preserve important features of the original signal in the resulting smoothed timeseries.</p>
</div>
<div class="section" id="operations-with-real-dataset">
<h2>Operations with  real dataset<a class="headerlink" href="#operations-with-real-dataset" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read CSV file</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../datasets/ok_mesonet_8_apr_2019.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STID</th>
      <th>NAME</th>
      <th>ST</th>
      <th>LAT</th>
      <th>LON</th>
      <th>YR</th>
      <th>MO</th>
      <th>DA</th>
      <th>HR</th>
      <th>MI</th>
      <th>...</th>
      <th>RELH</th>
      <th>CHIL</th>
      <th>HEAT</th>
      <th>WDIR</th>
      <th>WSPD</th>
      <th>WMAX</th>
      <th>PRES</th>
      <th>TMAX</th>
      <th>TMIN</th>
      <th>RAIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACME</td>
      <td>Acme</td>
      <td>OK</td>
      <td>34.81</td>
      <td>-98.02</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>ADAX</td>
      <td>Ada</td>
      <td>OK</td>
      <td>34.80</td>
      <td>-96.67</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>40</td>
      <td></td>
      <td></td>
      <td>S</td>
      <td>12</td>
      <td>20</td>
      <td>1011.13</td>
      <td>78</td>
      <td>48</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>ALTU</td>
      <td>Altus</td>
      <td>OK</td>
      <td>34.59</td>
      <td>-99.34</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>39</td>
      <td></td>
      <td>82</td>
      <td>SSW</td>
      <td>19</td>
      <td>26</td>
      <td>1007.86</td>
      <td>82</td>
      <td>45</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>ALV2</td>
      <td>Alva</td>
      <td>OK</td>
      <td>36.71</td>
      <td>-98.71</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>32</td>
      <td></td>
      <td>82</td>
      <td>S</td>
      <td>20</td>
      <td>26</td>
      <td>1004.65</td>
      <td>84</td>
      <td>40</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>ANT2</td>
      <td>Antlers</td>
      <td>OK</td>
      <td>34.25</td>
      <td>-95.67</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>35</td>
      <td></td>
      <td></td>
      <td>S</td>
      <td>11</td>
      <td>20</td>
      <td>1013.64</td>
      <td>78</td>
      <td>38</td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
<p>Some columns with empty cells. Ideally we would like to represent missing values with <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. Be filling this cell we need to identify whether they are truly empty or something else is there (e.g. empty string).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print one the cells to see what&#39;s in there</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;RAIN&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39; &#39;
</pre></div>
</div>
</div>
</div>
<p>There is a string with a single space. Now we can use the <code class="docutils literal notranslate"><span class="pre">replace()</span></code> method to substitute these strings for <code class="docutils literal notranslate"><span class="pre">NaN</span></code> from the Numpy module.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> replaces the string with <code class="docutils literal notranslate"><span class="pre">NaN</span></code> without generating a copy of the Pandas DataFrame</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STID</th>
      <th>NAME</th>
      <th>ST</th>
      <th>LAT</th>
      <th>LON</th>
      <th>YR</th>
      <th>MO</th>
      <th>DA</th>
      <th>HR</th>
      <th>MI</th>
      <th>...</th>
      <th>RELH</th>
      <th>CHIL</th>
      <th>HEAT</th>
      <th>WDIR</th>
      <th>WSPD</th>
      <th>WMAX</th>
      <th>PRES</th>
      <th>TMAX</th>
      <th>TMIN</th>
      <th>RAIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACME</td>
      <td>Acme</td>
      <td>OK</td>
      <td>34.81</td>
      <td>-98.02</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ADAX</td>
      <td>Ada</td>
      <td>OK</td>
      <td>34.80</td>
      <td>-96.67</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>40</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>S</td>
      <td>12</td>
      <td>20</td>
      <td>1011.13</td>
      <td>78</td>
      <td>48</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ALTU</td>
      <td>Altus</td>
      <td>OK</td>
      <td>34.59</td>
      <td>-99.34</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>39</td>
      <td>NaN</td>
      <td>82</td>
      <td>SSW</td>
      <td>19</td>
      <td>26</td>
      <td>1007.86</td>
      <td>82</td>
      <td>45</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ALV2</td>
      <td>Alva</td>
      <td>OK</td>
      <td>36.71</td>
      <td>-98.71</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>32</td>
      <td>NaN</td>
      <td>82</td>
      <td>S</td>
      <td>20</td>
      <td>26</td>
      <td>1004.65</td>
      <td>84</td>
      <td>40</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ANT2</td>
      <td>Antlers</td>
      <td>OK</td>
      <td>34.25</td>
      <td>-95.67</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>35</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>S</td>
      <td>11</td>
      <td>20</td>
      <td>1013.64</td>
      <td>78</td>
      <td>38</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
<div class="section" id="match-specific-stations">
<h3>Match specific stations<a class="headerlink" href="#match-specific-stations" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_acme</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;STID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;ACME&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="n">idx_acme</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STID</th>
      <th>NAME</th>
      <th>ST</th>
      <th>LAT</th>
      <th>LON</th>
      <th>YR</th>
      <th>MO</th>
      <th>DA</th>
      <th>HR</th>
      <th>MI</th>
      <th>...</th>
      <th>RELH</th>
      <th>CHIL</th>
      <th>HEAT</th>
      <th>WDIR</th>
      <th>WSPD</th>
      <th>WMAX</th>
      <th>PRES</th>
      <th>TMAX</th>
      <th>TMIN</th>
      <th>RAIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACME</td>
      <td>Acme</td>
      <td>OK</td>
      <td>34.81</td>
      <td>-98.02</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 22 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_starts_with_A</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;STID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="n">idx_starts_with_A</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STID</th>
      <th>NAME</th>
      <th>ST</th>
      <th>LAT</th>
      <th>LON</th>
      <th>YR</th>
      <th>MO</th>
      <th>DA</th>
      <th>HR</th>
      <th>MI</th>
      <th>...</th>
      <th>RELH</th>
      <th>CHIL</th>
      <th>HEAT</th>
      <th>WDIR</th>
      <th>WSPD</th>
      <th>WMAX</th>
      <th>PRES</th>
      <th>TMAX</th>
      <th>TMIN</th>
      <th>RAIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACME</td>
      <td>Acme</td>
      <td>OK</td>
      <td>34.81</td>
      <td>-98.02</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ADAX</td>
      <td>Ada</td>
      <td>OK</td>
      <td>34.80</td>
      <td>-96.67</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>40</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>S</td>
      <td>12</td>
      <td>20</td>
      <td>1011.13</td>
      <td>78</td>
      <td>48</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ALTU</td>
      <td>Altus</td>
      <td>OK</td>
      <td>34.59</td>
      <td>-99.34</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>39</td>
      <td>NaN</td>
      <td>82</td>
      <td>SSW</td>
      <td>19</td>
      <td>26</td>
      <td>1007.86</td>
      <td>82</td>
      <td>45</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ALV2</td>
      <td>Alva</td>
      <td>OK</td>
      <td>36.71</td>
      <td>-98.71</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>32</td>
      <td>NaN</td>
      <td>82</td>
      <td>S</td>
      <td>20</td>
      <td>26</td>
      <td>1004.65</td>
      <td>84</td>
      <td>40</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ANT2</td>
      <td>Antlers</td>
      <td>OK</td>
      <td>34.25</td>
      <td>-95.67</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>35</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>S</td>
      <td>11</td>
      <td>20</td>
      <td>1013.64</td>
      <td>78</td>
      <td>38</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>APAC</td>
      <td>Apache</td>
      <td>OK</td>
      <td>34.91</td>
      <td>-98.29</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>41</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>S</td>
      <td>23</td>
      <td>29</td>
      <td>1008.9</td>
      <td>80</td>
      <td>49</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ARD2</td>
      <td>Ardmore</td>
      <td>OK</td>
      <td>34.19</td>
      <td>-97.09</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>41</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>S</td>
      <td>18</td>
      <td>26</td>
      <td>1011.43</td>
      <td>77</td>
      <td>50</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ARNE</td>
      <td>Arnett</td>
      <td>OK</td>
      <td>36.07</td>
      <td>-99.90</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>10</td>
      <td>NaN</td>
      <td>85</td>
      <td>SW</td>
      <td>22</td>
      <td>32</td>
      <td>1005.13</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 22 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_has_A</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;STID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="n">idx_has_A</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STID</th>
      <th>NAME</th>
      <th>ST</th>
      <th>LAT</th>
      <th>LON</th>
      <th>YR</th>
      <th>MO</th>
      <th>DA</th>
      <th>HR</th>
      <th>MI</th>
      <th>...</th>
      <th>RELH</th>
      <th>CHIL</th>
      <th>HEAT</th>
      <th>WDIR</th>
      <th>WSPD</th>
      <th>WMAX</th>
      <th>PRES</th>
      <th>TMAX</th>
      <th>TMIN</th>
      <th>RAIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACME</td>
      <td>Acme</td>
      <td>OK</td>
      <td>34.81</td>
      <td>-98.02</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ADAX</td>
      <td>Ada</td>
      <td>OK</td>
      <td>34.80</td>
      <td>-96.67</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>40</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>S</td>
      <td>12</td>
      <td>20</td>
      <td>1011.13</td>
      <td>78</td>
      <td>48</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ALTU</td>
      <td>Altus</td>
      <td>OK</td>
      <td>34.59</td>
      <td>-99.34</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>39</td>
      <td>NaN</td>
      <td>82</td>
      <td>SSW</td>
      <td>19</td>
      <td>26</td>
      <td>1007.86</td>
      <td>82</td>
      <td>45</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ALV2</td>
      <td>Alva</td>
      <td>OK</td>
      <td>36.71</td>
      <td>-98.71</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>32</td>
      <td>NaN</td>
      <td>82</td>
      <td>S</td>
      <td>20</td>
      <td>26</td>
      <td>1004.65</td>
      <td>84</td>
      <td>40</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ANT2</td>
      <td>Antlers</td>
      <td>OK</td>
      <td>34.25</td>
      <td>-95.67</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>35</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>S</td>
      <td>11</td>
      <td>20</td>
      <td>1013.64</td>
      <td>78</td>
      <td>38</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>APAC</td>
      <td>Apache</td>
      <td>OK</td>
      <td>34.91</td>
      <td>-98.29</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>41</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>S</td>
      <td>23</td>
      <td>29</td>
      <td>1008.9</td>
      <td>80</td>
      <td>49</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ARD2</td>
      <td>Ardmore</td>
      <td>OK</td>
      <td>34.19</td>
      <td>-97.09</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>41</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>S</td>
      <td>18</td>
      <td>26</td>
      <td>1011.43</td>
      <td>77</td>
      <td>50</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ARNE</td>
      <td>Arnett</td>
      <td>OK</td>
      <td>36.07</td>
      <td>-99.90</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>10</td>
      <td>NaN</td>
      <td>85</td>
      <td>SW</td>
      <td>22</td>
      <td>32</td>
      <td>1005.13</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>BEAV</td>
      <td>Beaver</td>
      <td>OK</td>
      <td>36.80</td>
      <td>-100.53</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>9</td>
      <td>NaN</td>
      <td>84</td>
      <td>SW</td>
      <td>17</td>
      <td>26</td>
      <td>1003.9</td>
      <td>91</td>
      <td>34</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>BLAC</td>
      <td>Blackwell</td>
      <td>OK</td>
      <td>36.75</td>
      <td>-97.25</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>38</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>SSW</td>
      <td>15</td>
      <td>23</td>
      <td>1007.02</td>
      <td>80</td>
      <td>44</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20</th>
      <td>BYAR</td>
      <td>Byars</td>
      <td>OK</td>
      <td>34.85</td>
      <td>-97.00</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>43</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>S</td>
      <td>22</td>
      <td>32</td>
      <td>1010.64</td>
      <td>77</td>
      <td>49</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>21</th>
      <td>CAMA</td>
      <td>Camargo</td>
      <td>OK</td>
      <td>36.03</td>
      <td>-99.35</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>32</td>
      <td>NaN</td>
      <td>82</td>
      <td>S</td>
      <td>23</td>
      <td>29</td>
      <td>1005.56</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>22</th>
      <td>CARL</td>
      <td>Lake Carl Blackwell</td>
      <td>OK</td>
      <td>36.15</td>
      <td>-97.29</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>36</td>
      <td>NaN</td>
      <td>80</td>
      <td>S</td>
      <td>17</td>
      <td>25</td>
      <td>1007.56</td>
      <td>80</td>
      <td>50</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24</th>
      <td>CHAN</td>
      <td>Chandler</td>
      <td>OK</td>
      <td>35.65</td>
      <td>-96.80</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>37</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>SSW</td>
      <td>16</td>
      <td>27</td>
      <td>1009.35</td>
      <td>80</td>
      <td>48</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>28</th>
      <td>CLAY</td>
      <td>Clayton</td>
      <td>OK</td>
      <td>34.66</td>
      <td>-95.33</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>36</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>S</td>
      <td>9</td>
      <td>24</td>
      <td>1012.9</td>
      <td>78</td>
      <td>40</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>15 rows × 22 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Blackwell&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Lake&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STID</th>
      <th>NAME</th>
      <th>ST</th>
      <th>LAT</th>
      <th>LON</th>
      <th>YR</th>
      <th>MO</th>
      <th>DA</th>
      <th>HR</th>
      <th>MI</th>
      <th>...</th>
      <th>RELH</th>
      <th>CHIL</th>
      <th>HEAT</th>
      <th>WDIR</th>
      <th>WSPD</th>
      <th>WMAX</th>
      <th>PRES</th>
      <th>TMAX</th>
      <th>TMIN</th>
      <th>RAIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>22</th>
      <td>CARL</td>
      <td>Lake Carl Blackwell</td>
      <td>OK</td>
      <td>36.15</td>
      <td>-97.29</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>36</td>
      <td>NaN</td>
      <td>80</td>
      <td>S</td>
      <td>17</td>
      <td>25</td>
      <td>1007.56</td>
      <td>80</td>
      <td>50</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 22 columns</p>
</div></div></div>
</div>
<p>The following line won’t work because the string matching is case sensitive:</p>
<p><code class="docutils literal notranslate"><span class="pre">idx</span> <span class="pre">=</span> <span class="pre">df['NAME'].str.contains('LAKE')</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Blackwell&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Lake&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STID</th>
      <th>NAME</th>
      <th>ST</th>
      <th>LAT</th>
      <th>LON</th>
      <th>YR</th>
      <th>MO</th>
      <th>DA</th>
      <th>HR</th>
      <th>MI</th>
      <th>...</th>
      <th>RELH</th>
      <th>CHIL</th>
      <th>HEAT</th>
      <th>WDIR</th>
      <th>WSPD</th>
      <th>WMAX</th>
      <th>PRES</th>
      <th>TMAX</th>
      <th>TMIN</th>
      <th>RAIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11</th>
      <td>BLAC</td>
      <td>Blackwell</td>
      <td>OK</td>
      <td>36.75</td>
      <td>-97.25</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>38</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>SSW</td>
      <td>15</td>
      <td>23</td>
      <td>1007.02</td>
      <td>80</td>
      <td>44</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>22</th>
      <td>CARL</td>
      <td>Lake Carl Blackwell</td>
      <td>OK</td>
      <td>36.15</td>
      <td>-97.29</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>36</td>
      <td>NaN</td>
      <td>80</td>
      <td>S</td>
      <td>17</td>
      <td>25</td>
      <td>1007.56</td>
      <td>80</td>
      <td>50</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 22 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;STID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;ACME&#39;</span><span class="p">,</span><span class="s1">&#39;ALTU&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STID</th>
      <th>NAME</th>
      <th>ST</th>
      <th>LAT</th>
      <th>LON</th>
      <th>YR</th>
      <th>MO</th>
      <th>DA</th>
      <th>HR</th>
      <th>MI</th>
      <th>...</th>
      <th>RELH</th>
      <th>CHIL</th>
      <th>HEAT</th>
      <th>WDIR</th>
      <th>WSPD</th>
      <th>WMAX</th>
      <th>PRES</th>
      <th>TMAX</th>
      <th>TMIN</th>
      <th>RAIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACME</td>
      <td>Acme</td>
      <td>OK</td>
      <td>34.81</td>
      <td>-98.02</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ALTU</td>
      <td>Altus</td>
      <td>OK</td>
      <td>34.59</td>
      <td>-99.34</td>
      <td>2019</td>
      <td>4</td>
      <td>15</td>
      <td>15</td>
      <td>20</td>
      <td>...</td>
      <td>39</td>
      <td>NaN</td>
      <td>82</td>
      <td>SSW</td>
      <td>19</td>
      <td>26</td>
      <td>1007.86</td>
      <td>82</td>
      <td>45</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 22 columns</p>
</div></div></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="photoperiod_numpy_module.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Photoperiod</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="import_tabular_data.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Import Tabular Data</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Andres Patrignani<br/>
    
        &copy; Copyright 2021.<br/>
      <div class="extra_footer">
        <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Licensed under CC BY-NC-SA</a>
      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>